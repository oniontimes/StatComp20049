<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>



<div id="homework-2020-09-22" class="section level2">
<h2>homework 2020-09-22</h2>
<div id="first-example" class="section level3">
<h3>First Example</h3>
<p>The 1st example should contain texts and at least one figure.</p>
<p>We can use the examples in the <em>Reproducible Research with R</em>. The following is the basic R code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>ctl &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">4.17</span>,<span class="fl">5.58</span>,<span class="fl">5.18</span>,<span class="fl">6.11</span>,<span class="fl">4.50</span>,<span class="fl">4.61</span>,<span class="fl">5.17</span>,<span class="fl">4.53</span>,<span class="fl">5.33</span>,<span class="fl">5.14</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>trt &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">4.81</span>,<span class="fl">4.17</span>,<span class="fl">4.41</span>,<span class="fl">3.59</span>,<span class="fl">5.87</span>,<span class="fl">3.83</span>,<span class="fl">6.03</span>,<span class="fl">4.89</span>,<span class="fl">4.32</span>,<span class="fl">4.69</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>group &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Ctl&quot;</span>,<span class="st">&quot;Trt&quot;</span>))</span>
<span id="cb1-4"><a href="#cb1-4"></a>weight &lt;-<span class="st"> </span><span class="kw">c</span>(ctl, trt)</span>
<span id="cb1-5"><a href="#cb1-5"></a>lm.D9 &lt;-<span class="st"> </span><span class="kw">lm</span>(weight <span class="op">~</span><span class="st"> </span>group)</span></code></pre></div>
<p>We could use the following R code to plot our results:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">plot</span>(lm.D9)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="second-example" class="section level3">
<h3>Second Example</h3>
<p>The 2nd example should contains texts and at least one table.</p>
<p>We use a built-in data set <em>mtcars</em> in R for demonstration.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>data &lt;-<span class="st"> </span><span class="kw">head</span>(mtcars)</span></code></pre></div>
<p>We use <em>kableExtra</em> package in R to embellish the table:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">library</span>(knitr)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;knitr&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">library</span>(kableExtra)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;kableExtra&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="st">  </span><span class="kw">kable_styling</span>(<span class="st">&quot;striped&quot;</span>, <span class="dt">full_width =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="st">  </span><span class="kw">column_spec</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">bold =</span> T) </span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mpg
</th>
<th style="text-align:right;">
cyl
</th>
<th style="text-align:right;">
disp
</th>
<th style="text-align:right;">
hp
</th>
<th style="text-align:right;">
drat
</th>
<th style="text-align:right;">
wt
</th>
<th style="text-align:right;">
qsec
</th>
<th style="text-align:right;">
vs
</th>
<th style="text-align:right;">
am
</th>
<th style="text-align:right;">
gear
</th>
<th style="text-align:right;">
carb
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mazda RX4
</td>
<td style="text-align:right;font-weight: bold;">
21.0
</td>
<td style="text-align:right;font-weight: bold;">
6
</td>
<td style="text-align:right;font-weight: bold;">
160
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
2.620
</td>
<td style="text-align:right;">
16.46
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4 Wag
</td>
<td style="text-align:right;font-weight: bold;">
21.0
</td>
<td style="text-align:right;font-weight: bold;">
6
</td>
<td style="text-align:right;font-weight: bold;">
160
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
2.875
</td>
<td style="text-align:right;">
17.02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Datsun 710
</td>
<td style="text-align:right;font-weight: bold;">
22.8
</td>
<td style="text-align:right;font-weight: bold;">
4
</td>
<td style="text-align:right;font-weight: bold;">
108
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
3.85
</td>
<td style="text-align:right;">
2.320
</td>
<td style="text-align:right;">
18.61
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet 4 Drive
</td>
<td style="text-align:right;font-weight: bold;">
21.4
</td>
<td style="text-align:right;font-weight: bold;">
6
</td>
<td style="text-align:right;font-weight: bold;">
258
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.08
</td>
<td style="text-align:right;">
3.215
</td>
<td style="text-align:right;">
19.44
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet Sportabout
</td>
<td style="text-align:right;font-weight: bold;">
18.7
</td>
<td style="text-align:right;font-weight: bold;">
8
</td>
<td style="text-align:right;font-weight: bold;">
360
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
3.15
</td>
<td style="text-align:right;">
3.440
</td>
<td style="text-align:right;">
17.02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Valiant
</td>
<td style="text-align:right;font-weight: bold;">
18.1
</td>
<td style="text-align:right;font-weight: bold;">
6
</td>
<td style="text-align:right;font-weight: bold;">
225
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
2.76
</td>
<td style="text-align:right;">
3.460
</td>
<td style="text-align:right;">
20.22
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="third-example" class="section level3">
<h3>Third Example</h3>
<p>The 3rd example should contain at least a couple of LaTeX formulas.</p>
<p>We want to solve the question:<br />
Suppose <span class="math inline">\(x \neq y \in R\)</span>, <span class="math inline">\(F_n(x)\)</span> is the EDF. Solve <span class="math inline">\(Cov (F_n(x), F_n(y))\)</span>.<br />
<strong>Proof:</strong> Without loss of generality, suppose <span class="math inline">\(x &lt; y\)</span>. We have that <span class="math inline">\(EF_n(x) = F(x)\)</span>, <span class="math inline">\(EF_n(y) = F(y)\)</span>. We only need to calculate <span class="math inline">\(EF_n(x)F_n(y)\)</span>. <span class="math display">\[
P(F_{n}(x)=\frac{i}{n},F_{n}(y)=\frac{j}{n})=\frac{n!}{i!(j − i)!(n − j)!}F^{i}(x)(F(y)-F(x))^{j-i}(1-F(y))^{n-j},\quad i&lt;j
\]</span> then we could have: <span class="math display">\[
\begin{aligned}
EF_{n}(x)F_{n}(y) &amp;= \sum_{i\leq j}\frac{ij}{n^2}\frac{n!}{i!(j − i)!(n − j)!}F^{i}(x)(F(y)-F(x))^{j-i}(1-F(y))^{n-j} \\
&amp;= \sum_{j=1}^{n}\frac{j}{n(n-j)!}(1-F(y))^{n-j}\sum_{i=1}^{j}\frac{(n-1)!}{(i-1)!(j − i)!}F^{i}(x)(F(y)-F(x))^{j-i}\\
&amp;= \sum_{j=1}^{n}\frac{j(n-1)!}{n(n-j)!(j-1)!}(1-F(y))^{n-j}F(x)F^{j-1}(y)\sum_{i=0}^{j-1}\frac{(j-1)!}{i!(j − i-1)!}(\frac{F(x)}{F(y)})^{i}(1-\frac{F(x)}{F(y)})^{j-i-1}\\
&amp;=F(x)\sum_{j=0}^{n-1}\frac{j+1}{n}\frac{(n-1)!}{j!(n − j-1)!}(1-F(y))^{n-j-1}F^{j}(y)\\
&amp;=F(x)\frac{(n − 1)F(y)+1}{n}
\end{aligned}
\]</span></p>
</div>
</div>
<div id="homework-2020-09-29" class="section level2">
<h2>homework 2020-09-29</h2>
<div id="question-3.3" class="section level3">
<h3>Question 3.3</h3>
<p>The <span class="math inline">\(Pareto(a, b)\)</span> distribution has cdf: <span class="math display">\[
F(x)=1-(\frac{b}{x})^a,\quad x\geq b&gt;0,\quad a&gt;0.
\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{−1}(U)\)</span> and use the inverse transform method to simulate a random sample from the <span class="math inline">\(Pareto(2, 2)\)</span> distribution. Graph the density histogram of the sample with the <span class="math inline">\(Pareto(2, 2)\)</span> density superimposed for comparison.</p>
<p>We could obtain the inverse transformation <span class="math inline">\(F^{-1}(y)=b(1-y)^{-\frac{1}{a}}\)</span>, in which <span class="math inline">\(a=2, b=2\)</span>. Then we could use R code to simulate a random sample from the <span class="math inline">\(Pareto(2, 2)\)</span> distribution.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>n &lt;-<span class="st"> </span><span class="dv">5000</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb9-3"><a href="#cb9-3"></a>x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>u))</span></code></pre></div>
<p>We get a random sample from the <span class="math inline">\(Pareto(2, 2)\)</span> distribution.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>x[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 5.273893</code></pre>
<p>Now, we try to graph the density histogram of the sample with the <span class="math inline">\(Pareto(2, 2)\)</span> density superimposed for comparison.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">hist</span>(x, <span class="dt">breaks=</span><span class="dv">200</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),  <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">8</span><span class="op">/</span>x<span class="op">^</span><span class="dv">3</span>))</span>
<span id="cb12-2"><a href="#cb12-2"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">100</span>, <span class="fl">0.1</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="kw">lines</span>(y, <span class="dv">8</span><span class="op">*</span>y<span class="op">^-</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.9" class="section level3">
<h3>Question 3.9</h3>
<p>The rescaled Epanechnikov kernel is a symmetric density function: <span class="math display">\[
f_{e}(x)=\frac{3}{4}(1-x^2),\quad |x|&lt;1.
\]</span> Devroye and Gyorfi give the following algorithm for simulation from this distribution. Generate <span class="math inline">\(iid\quad U_1, U_2, U_3 ∼ Uniform(−1, 1)\)</span>. If <span class="math inline">\(|U3| \geq |U_2|\)</span> and <span class="math inline">\(|U_3|\geq|U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
<p>The following is the R code:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>n &lt;-<span class="st"> </span><span class="dv">500</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>u &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(n<span class="op">*</span><span class="dv">3</span>,<span class="dt">min=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">max=</span><span class="dv">1</span>),<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>n)</span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n )</span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="cf">if</span>(<span class="kw">abs</span>(u[i,<span class="dv">3</span>])<span class="op">&gt;=</span><span class="kw">abs</span>(u[i,<span class="dv">1</span>])<span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">abs</span>(u[i,<span class="dv">3</span>])<span class="op">&gt;=</span><span class="kw">abs</span>(u[i,<span class="dv">2</span>])){</span>
<span id="cb13-6"><a href="#cb13-6"></a>    x[i]=u[i,<span class="dv">2</span>]</span>
<span id="cb13-7"><a href="#cb13-7"></a>  }<span class="cf">else</span>{</span>
<span id="cb13-8"><a href="#cb13-8"></a>    x[i]=u[i,<span class="dv">3</span>]</span>
<span id="cb13-9"><a href="#cb13-9"></a>  } </span></code></pre></div>
<p>We get a random sample from this distribution.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>x[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 0.5822324</code></pre>
<p>Now, we try to graph the density histogram of the samples.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">hist</span>(x,  <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="fl">0.75</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.10" class="section level3">
<h3>Question 3.10</h3>
<p>Prove that the algorithm given in Question 3.9 generates variates from the density <span class="math inline">\(f_e\)</span> (3.10).</p>
<p><strong>PF</strong>: In order to prove the density, we should first calculate its cdf. In other words, we should calculate <span class="math inline">\(F(t)=P(X&lt;t),\quad t\in[-1,1]\)</span>. The event that <span class="math inline">\(X\leq t\)</span> decomposes into two disjoint possibilities:</p>
<p>First, we consider <span class="math inline">\(t&gt;0\)</span>:<br />
1. At least two of the <span class="math inline">\(X_i\)</span> lie in [-t,t]:<br />
- <span class="math inline">\(X_1,X_2\in[-t,t]\)</span>, then <span class="math inline">\(X&lt;t\)</span><br />
- <span class="math inline">\(X_1,X_3\in[-t,t]\)</span>, then <span class="math inline">\(X&lt;t\)</span><br />
- <span class="math inline">\(X_2,X_3\in[-t,t]\)</span>, then <span class="math inline">\(X&lt;t\)</span><br />
- <span class="math inline">\(X_1,X_2,X_3\in[-t,t]\)</span>, then <span class="math inline">\(X&lt;t\)</span><br />
2. Exactly one of the <span class="math inline">\(X_i\)</span> lies in [-t,t]: - <span class="math inline">\(X_2\in[-t,t]\)</span>, then <span class="math inline">\(X&lt;t\)</span> only if <span class="math inline">\(|X_3|&gt;|X_1|\)</span><br />
- <span class="math inline">\(X_3\in[-t,t]\)</span>, then <span class="math inline">\(X&lt;t\)</span></p>
<p>So, the distribution function is: <span class="math display">\[
F(t)=3(\frac{2t}{2})^2(\frac{2-2t}{2})+(\frac{2t}{2})^3+\frac{1}{2}(\frac{2t}{2})(\frac{2-2t}{2})^2+(\frac{2t}{2})(\frac{2-2t}{2})^2
\]</span> Therefore: <span class="math display">\[
F(t)=-\frac{t^3}{2}+\frac{3}{2}t
\]</span> Extending <span class="math inline">\(t\)</span> to the domain [−1,1] by symmetry <span class="math display">\[
F_e(x)=\frac{1}{2}F(t)=-\frac{t^3}{4}+\frac{3}{4}t
\]</span> Therefore, <span class="math display">\[
f_e(x)=-\frac{3}{4}t^2+\frac{3}{4}
\]</span></p>
</div>
<div id="question-3.13" class="section level3">
<h3>Question 3.13</h3>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf: <span class="math display">\[
F(y)=1 − (\frac{\beta}{\beta+y})^r, y ≥ 0.
\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(r = 4\)</span> and <span class="math inline">\(\beta = 2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
<p>We could get <span class="math inline">\(F^{-1}(x)=\beta((\frac{1}{1-x})^{1/r}-1)\)</span>. So, we could build simulation in R code:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>n &lt;-<span class="st"> </span><span class="dv">500</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb17-3"><a href="#cb17-3"></a>x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">4</span>}<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="kw">hist</span>(x,<span class="dt">breaks=</span><span class="dv">100</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">64</span>(<span class="dv">2</span><span class="op">+</span>x)<span class="op">^</span>{<span class="op">-</span><span class="dv">5</span>}))</span>
<span id="cb17-5"><a href="#cb17-5"></a>y=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">8</span>,<span class="fl">0.01</span>)</span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="kw">lines</span>(y,<span class="dv">64</span><span class="op">*</span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span>{<span class="op">-</span><span class="dv">5</span>},<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="homework-2020-10-13" class="section level2">
<h2>homework 2020-10-13</h2>
<div id="question-5.1" class="section level3">
<h3>Question 5.1</h3>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\begin{equation}
\int_{0}^{\pi/3}\sin t\,\mathrm{d}t
\end{equation}\]</span> and compare your estimate with the exact value of the integral.</p>
<p><span class="math display">\[\int_a^b h(x)dx = \int_a^b g(x)\frac1{b-a}dx=E[g(X)],\]</span> where <span class="math inline">\(X\sim U(a,b),g(x)=(b-a)h(x).\)</span></p>
<p>So we have: <span class="math display">\[
\int_{0}^{\pi/3}\sin t\,\mathrm{d}t = \frac{\pi}{3}E[\sin X], X\sim U(0,\frac{\pi}{3}).
\]</span></p>
<p>Then we can compute a Monte Carlo estimate of it:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x)) <span class="op">*</span><span class="st"> </span>pi <span class="op">/</span><span class="st"> </span><span class="dv">3</span></span></code></pre></div>
<p>The estimate and true value:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">c</span>(theta.hat, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.4997336 0.5000000</code></pre>
</div>
<div id="question-5.7" class="section level3">
<h3>Question 5.7</h3>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
<p>We give a simple estimator: <span class="math display">\[\begin{equation}
\hat{\theta}_1 = \frac{1}{m}\sum\limits_{j=1}^{m}e^{X_{j}},X_{j}\sim U(0,1).
\end{equation}\]</span></p>
<p>Estimate <span class="math inline">\(\theta\)</span> by the simple Monte Carlo method:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>x1 &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a>theta_hat_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(x1)</span></code></pre></div>
<p>We give a estimator by the antithetic variate approach: <span class="math display">\[\begin{equation}
\hat\theta_2 = \frac{1}{m}\sum\limits_{j=1}^{m/2}(e^{X_{j}}+e^{1-X_{j}}),X_{j}\sim U(0,1).
\end{equation}\]</span></p>
<p>Estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>m &lt;-<span class="st"> </span><span class="fl">5e4</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>x2 &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>);</span>
<span id="cb22-4"><a href="#cb22-4"></a>theta_hat_<span class="dv">2</span> &lt;-<span class="st"> </span>(<span class="kw">exp</span>(x2) <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>x2)) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span></code></pre></div>
<p>Compute an empirical estimate of the percent reduction in variance using the antithetic variate:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">var</span>(theta_hat_<span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">var</span>(theta_hat_<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 0.9838219</code></pre>
<p><span class="math display">\[\theta=\int_0^1 e^xdx\]</span> <span class="math display">\[Var(e^U)=E(e^{2U})-(E(e^U))^2=\int_0^1 e^{2x}dx-(\int_0^1 e^{x}dx)^2=\frac{1}{2}(e^2-1)-(e-1)^2=0.2420\]</span> <span class="math display">\[Cov(e^U,e^{1-U})=E(e^{U+1-U)})-E(e^U)E(e^{1-U})=e-\int_0^1e^xdx \int_0^1e^{1-x}dx=-0.2342\]</span> <span class="math display">\[Var((e^U+e^{1-U})/2)=Var(e^U)/4+Var(e^{1-U})/4+Cov(e^U,e^{1-U})/2=0.0039\]</span></p>
<p>Thus, the theoretical value of percent reduction is <span class="math inline">\(1-0.0039/0.2420=98.39\%\)</span></p>
</div>
<div id="question-5.11" class="section level3">
<h3>Question 5.11</h3>
<p>If <span class="math inline">\(\hat\theta_{1}\)</span> and <span class="math inline">\(\hat\theta_{2}\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat\theta_{1}\)</span> and <span class="math inline">\(\hat\theta_{2}\)</span> are antithetic, we derived that <span class="math inline">\(c^{*} = 1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat\theta_{c} = c\hat\theta_{1} + (1-c)\hat\theta_{2}\)</span>. Derive <span class="math inline">\(c^{*}\)</span> for the general case. That is, if <span class="math inline">\(\hat\theta_{1}\)</span> and <span class="math inline">\(\hat\theta_{2}\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^{*}\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat\theta_{c} = c\hat\theta_{1}+(1-c)\hat\theta_{2}\)</span> in equation (5.11). (<span class="math inline">\(c^{*}\)</span> will be a function of the variances and the covariance of the estimators.)</p>
<p><span class="math display">\[\begin{align}
var(\hat\theta_c)&amp;=c^2var(\hat\theta_1)+(1-c)^2var(\hat\theta_2)+2c(1-c)Cov(\hat\theta_1,\hat\theta_2)\\
&amp;=(var(\hat\theta_1)+var(\hat\theta_2)-2Cov(\hat\theta_1,\hat\theta_2))c^2+2c(Cov(\hat\theta_1,\hat\theta_2)-var(\hat\theta_2))+var(\hat\theta_2) \\
&amp;=var(\hat\theta_1-\hat\theta_2)c^2+2(Cov(\hat\theta_1,\hat\theta_2)-var(\hat\theta_2))c+var(\hat\theta_2)
\end{align}\]</span></p>
<p>So, <span class="math inline">\(c^*= \begin{cases} 0 &amp; ~~~~ \frac{Var(\hat{\theta}_2)-Cov(\hat{\theta}_1,\hat{\theta}_2)}{Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2)} &lt;0\\ \frac{Var(\hat{\theta}_2)-Cov(\hat{\theta}_1,\hat{\theta}_2)}{Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2)} &amp;~~~~ 0 \leq \frac{Var(\hat{\theta}_2)-Cov(\hat{\theta}_1,\hat{\theta}_2)}{Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2)} \leq 1 \\ 1 &amp; ~~~~ \frac{Var(\hat{\theta}_2)-Cov(\hat{\theta}_1,\hat{\theta}_2)}{Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2)} &gt;1\\ \end{cases}\)</span> minimizes the variance of the estimator.</p>
</div>
</div>
<div id="homework-2020-10-20" class="section level2">
<h2>homework 2020-10-20</h2>
<div id="section" class="section level3">
<h3>5.13</h3>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2}, \quad x&gt;1
\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[
\theta=\int_1^\infty\frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2}dx, \quad x&gt;1
\]</span> by importance sampling? Explain.</p>
<p>We first draw the plot of <span class="math inline">\(g(x)\)</span></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>x&lt;-<span class="kw">seq</span>(<span class="fl">1.005</span>,<span class="dv">5</span>,<span class="fl">0.01</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>gx&lt;-<span class="cf">function</span>(x){</span>
<span id="cb25-3"><a href="#cb25-3"></a>  ((x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>((<span class="dv">2</span><span class="op">*</span>pi)<span class="op">^</span><span class="fl">0.5</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a>}</span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="kw">plot</span>(x,<span class="kw">gx</span>(x),<span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>So, we choose <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> is normal distribution and chi square distribution.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>f1&lt;-<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>f2&lt;-<span class="kw">rchisq</span>(<span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb26-3"><a href="#cb26-3"></a>gf1&lt;-<span class="kw">gx</span>(f1)<span class="op">/</span><span class="kw">dnorm</span>(f1)</span>
<span id="cb26-4"><a href="#cb26-4"></a>gf2&lt;-<span class="kw">gx</span>(f2)<span class="op">/</span><span class="kw">dchisq</span>(f2,<span class="dv">2</span>)</span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="kw">cat</span>(<span class="st">&quot;the estimation of f1 is&quot;</span>,<span class="kw">mean</span>(gf1),<span class="st">&quot; and se is&quot;</span>,<span class="kw">sd</span>(gf1))</span></code></pre></div>
<pre><code>## the estimation of f1 is 0.7848548  and se is 1.928535</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">cat</span>(<span class="st">&quot; the estimation of f2 is&quot;</span>,<span class="kw">mean</span>(gf2),<span class="st">&quot; and se is&quot;</span>,<span class="kw">sd</span>(gf2))</span></code></pre></div>
<pre><code>##  the estimation of f2 is 0.4372436  and se is 0.5114131</code></pre>
<p>So, chi square distribution is good.</p>
</div>
<div id="section-1" class="section level3">
<h3>5.15</h3>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
<p>We get <span class="math inline">\(g(x)\)</span> like this:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>M &lt;-<span class="st"> </span><span class="dv">100</span>  <span class="co">#number of replicates</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb30-4"><a href="#cb30-4"></a>}</span></code></pre></div>
<p>Now divide the interval <span class="math inline">\((0,1)\)</span> into five subintervals, <span class="math inline">\((j/5,(j + 1)/5)\)</span>, <span class="math inline">\(j = 0, 1,\dots, 4\)</span>. Then on the <span class="math inline">\(j^{th}\)</span> subinterval variables are generated from the density, i.e. <span class="math inline">\(f_j(x)\)</span>: <span class="math display">\[
f_j(x)=\frac{e^{-x}}{e^{-\frac{j-1}{5}}-e^{-\frac{j}{5}}}, \quad \frac{j-1}{5}&lt;x&lt;\frac{j}{5}
\]</span></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>k &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co">#number of strata</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>N &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co">#number of times to repeat the estimation</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>estimates &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb31-4"><a href="#cb31-4"></a>thetahat &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb31-5"><a href="#cb31-5"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x,j) {</span>
<span id="cb31-6"><a href="#cb31-6"></a>  <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>))</span>
<span id="cb31-7"><a href="#cb31-7"></a>}</span>
<span id="cb31-8"><a href="#cb31-8"></a>gf &lt;-<span class="st"> </span><span class="cf">function</span>(x,j) {</span>
<span id="cb31-9"><a href="#cb31-9"></a>  <span class="kw">g</span>(x)<span class="op">/</span><span class="kw">f</span>(x,j)</span>
<span id="cb31-10"><a href="#cb31-10"></a>}</span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb31-12"><a href="#cb31-12"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</span>
<span id="cb31-13"><a href="#cb31-13"></a>    xx &lt;-<span class="st"> </span><span class="kw">runif</span>(M<span class="op">/</span>k,(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>,j<span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb31-14"><a href="#cb31-14"></a>    xxx &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">-</span><span class="st"> </span>xx <span class="op">*</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb31-15"><a href="#cb31-15"></a>    thetahat[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">gf</span>(xxx,j))</span>
<span id="cb31-16"><a href="#cb31-16"></a>  }</span>
<span id="cb31-17"><a href="#cb31-17"></a>  estimates[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(thetahat)</span>
<span id="cb31-18"><a href="#cb31-18"></a>  estimates[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(thetahat)</span>
<span id="cb31-19"><a href="#cb31-19"></a>}</span>
<span id="cb31-20"><a href="#cb31-20"></a><span class="kw">cat</span>(<span class="st">&quot;thetahat is&quot;</span>, <span class="kw">mean</span>(estimates[,<span class="dv">1</span>]),<span class="st">&quot; estimated standard error is&quot;</span>, <span class="kw">sd</span>(estimates[,<span class="dv">2</span>]))</span></code></pre></div>
<pre><code>## thetahat is 0.5242034  estimated standard error is 5.191919e-05</code></pre>
</div>
<div id="section-2" class="section level3">
<h3>6.4</h3>
<p>Suppose that <span class="math inline">\(X_1,\dots,X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
<p>We notice <span class="math inline">\(X_i\)</span> is from a lognormal distribution, so <span class="math inline">\(\log X_i\sim N(\mu,\sigma^2)\)</span> and we have <span class="math display">\[
T=\frac{\bar{X}-\mu}{S / \sqrt{n}} \sim t(n-1)
\]</span> where <span class="math inline">\(\bar{X}=\sum\log X_i\)</span> and <span class="math inline">\(S^2\)</span> is the sample variance of <span class="math inline">\(\log X_i\)</span>.<br />
Therefore, a 95% confidence interval is <span class="math display">\[
\left(\bar{X}-t_{0.025} \frac{S}{\sqrt{n}}, \bar{X}+t_{0.025} \frac{S}{\sqrt{n}}\right)
\]</span> So we can write in r</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>alpha =<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb33-2"><a href="#cb33-2"></a>n =<span class="st"> </span><span class="dv">20</span>;</span>
<span id="cb33-3"><a href="#cb33-3"></a>m =<span class="st"> </span><span class="dv">100</span>;</span>
<span id="cb33-4"><a href="#cb33-4"></a></span>
<span id="cb33-5"><a href="#cb33-5"></a>UCL =<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb33-6"><a href="#cb33-6"></a>LCL =<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb33-7"><a href="#cb33-7"></a></span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)</span>
<span id="cb33-9"><a href="#cb33-9"></a>{</span>
<span id="cb33-10"><a href="#cb33-10"></a>    x =<span class="st"> </span><span class="kw">rlnorm</span>(n,<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb33-11"><a href="#cb33-11"></a>    LCL[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">log</span>(x)) <span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(x)) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)</span>
<span id="cb33-12"><a href="#cb33-12"></a>    UCL[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">log</span>(x)) <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(x)) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)</span>
<span id="cb33-13"><a href="#cb33-13"></a>}</span>
<span id="cb33-14"><a href="#cb33-14"></a></span>
<span id="cb33-15"><a href="#cb33-15"></a><span class="kw">cat</span>(<span class="st">&quot;t-interval is&quot;</span>, <span class="st">&quot;[&quot;</span>,<span class="kw">mean</span>(LCL),<span class="st">&quot;,&quot;</span>,<span class="kw">mean</span>(UCL),<span class="st">&quot;]&quot;</span>)</span></code></pre></div>
<pre><code>## t-interval is [ -0.459214 , 0.4642416 ]</code></pre>
</div>
<div id="section-3" class="section level3">
<h3>6.5</h3>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<p>Use a Monte Carlo experiment to estimate the coverage probability of the t-interval:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>alpha =<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb35-2"><a href="#cb35-2"></a>n =<span class="st"> </span><span class="dv">20</span>;</span>
<span id="cb35-3"><a href="#cb35-3"></a>m =<span class="st"> </span><span class="dv">100</span>;</span>
<span id="cb35-4"><a href="#cb35-4"></a></span>
<span id="cb35-5"><a href="#cb35-5"></a>UCL =<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb35-6"><a href="#cb35-6"></a>LCL =<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb35-7"><a href="#cb35-7"></a></span>
<span id="cb35-8"><a href="#cb35-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)</span>
<span id="cb35-9"><a href="#cb35-9"></a>{</span>
<span id="cb35-10"><a href="#cb35-10"></a>    x =<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dv">2</span>)</span>
<span id="cb35-11"><a href="#cb35-11"></a>    LCL[i] =<span class="st"> </span><span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)</span>
<span id="cb35-12"><a href="#cb35-12"></a>    UCL[i] =<span class="st"> </span><span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)</span>
<span id="cb35-13"><a href="#cb35-13"></a>}</span>
<span id="cb35-14"><a href="#cb35-14"></a></span>
<span id="cb35-15"><a href="#cb35-15"></a><span class="kw">cat</span>(<span class="st">&quot;t-interval is&quot;</span>, <span class="st">&quot;[&quot;</span>,<span class="kw">mean</span>(LCL),<span class="st">&quot;,&quot;</span>,<span class="kw">mean</span>(UCL),<span class="st">&quot;]&quot;</span>,<span class="st">&quot; and coverage probability is&quot;</span>, <span class="kw">mean</span>(LCL <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## t-interval is [ 1.125199 , 2.846135 ]  and coverage probability is 0.88</code></pre>
<p>Now, we begin to compare.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>m &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>UCL =<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb37-5"><a href="#cb37-5"></a>LCL =<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)</span>
<span id="cb37-7"><a href="#cb37-7"></a>{</span>
<span id="cb37-8"><a href="#cb37-8"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">2</span>)</span>
<span id="cb37-9"><a href="#cb37-9"></a>  UCL[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">+</span><span class="st"> </span><span class="kw">sd</span>(x) <span class="op">*</span><span class="kw">qt</span>(alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb37-10"><a href="#cb37-10"></a>  LCL[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">-</span><span class="st"> </span><span class="kw">sd</span>(x) <span class="op">*</span><span class="kw">qt</span>(alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb37-11"><a href="#cb37-11"></a>}</span>
<span id="cb37-12"><a href="#cb37-12"></a><span class="kw">cat</span>(<span class="st">&quot;the result in example 6.4 is&quot;</span>, <span class="st">&quot;[&quot;</span>,<span class="kw">mean</span>(LCL),<span class="st">&quot;,&quot;</span>,<span class="kw">mean</span>(UCL),<span class="st">&quot;]&quot;</span>,<span class="st">&quot; and coverage probability is&quot;</span>, <span class="kw">mean</span>(LCL <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>))</span></code></pre></div>
<pre><code>## the result in example 6.4 is [ -0.9623278 , 0.8456721 ]  and coverage probability is 0.97</code></pre>
</div>
</div>
<div id="homework-2020-10-27" class="section level2">
<h2>homework 2020-10-27</h2>
<div id="section-4" class="section level3">
<h3>6.7</h3>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(α, α)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(ν)\)</span>?</p>
<p>use the method like the text book</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb39-2"><a href="#cb39-2"></a></span>
<span id="cb39-3"><a href="#cb39-3"></a>sk =<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb39-4"><a href="#cb39-4"></a>  xbar =<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb39-5"><a href="#cb39-5"></a>  m3 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb39-6"><a href="#cb39-6"></a>  m2 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb39-7"><a href="#cb39-7"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb39-8"><a href="#cb39-8"></a>}</span>
<span id="cb39-9"><a href="#cb39-9"></a></span>
<span id="cb39-10"><a href="#cb39-10"></a><span class="co"># beta(a,a)</span></span>
<span id="cb39-11"><a href="#cb39-11"></a>pwr_beta =<span class="st"> </span><span class="cf">function</span>(a){</span>
<span id="cb39-12"><a href="#cb39-12"></a> alpha =<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb39-13"><a href="#cb39-13"></a> n =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb39-14"><a href="#cb39-14"></a> m =<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb39-15"><a href="#cb39-15"></a> N =<span class="st"> </span><span class="kw">length</span>(a)</span>
<span id="cb39-16"><a href="#cb39-16"></a> pwr =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb39-17"><a href="#cb39-17"></a> cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb39-18"><a href="#cb39-18"></a> </span>
<span id="cb39-19"><a href="#cb39-19"></a> <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </span>
<span id="cb39-20"><a href="#cb39-20"></a>  sktests =<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb39-21"><a href="#cb39-21"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </span>
<span id="cb39-22"><a href="#cb39-22"></a>   x =<span class="st"> </span><span class="kw">rbeta</span>(n, a[j], a[j])</span>
<span id="cb39-23"><a href="#cb39-23"></a>   sktests[i] =<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb39-24"><a href="#cb39-24"></a>  }</span>
<span id="cb39-25"><a href="#cb39-25"></a>  pwr[j] =<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb39-26"><a href="#cb39-26"></a> }</span>
<span id="cb39-27"><a href="#cb39-27"></a> se =<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) </span>
<span id="cb39-28"><a href="#cb39-28"></a> <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">pwr =</span> pwr,<span class="dt">se =</span> se))</span>
<span id="cb39-29"><a href="#cb39-29"></a>}</span>
<span id="cb39-30"><a href="#cb39-30"></a></span>
<span id="cb39-31"><a href="#cb39-31"></a> a =<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>,<span class="dv">1</span>),<span class="kw">seq</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">10</span>))</span>
<span id="cb39-32"><a href="#cb39-32"></a> pwr =<span class="st"> </span><span class="kw">pwr_beta</span>(a)<span class="op">$</span>pwr</span>
<span id="cb39-33"><a href="#cb39-33"></a> <span class="co"># plot the power</span></span>
<span id="cb39-34"><a href="#cb39-34"></a> se =<span class="st"> </span><span class="kw">pwr_beta</span>(a)<span class="op">$</span>se</span>
<span id="cb39-35"><a href="#cb39-35"></a> <span class="kw">plot</span>(a, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;pwr&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb39-36"><a href="#cb39-36"></a> <span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.1</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb39-37"><a href="#cb39-37"></a> <span class="kw">lines</span>(a, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">4</span>)</span>
<span id="cb39-38"><a href="#cb39-38"></a> <span class="kw">lines</span>(a, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The power of the skewness test of normality against symmetric Beta(a,a) distribution is under 0.1. For a&lt; 1, the empirical power is more and more far away from 0.1 With the increase of a. And for a&gt;1, the empirical power increases to 0.1 when a increases.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># t(v)</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>pwr_t =<span class="st"> </span><span class="cf">function</span>(v){</span>
<span id="cb40-3"><a href="#cb40-3"></a> </span>
<span id="cb40-4"><a href="#cb40-4"></a> alpha =<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb40-5"><a href="#cb40-5"></a> n =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb40-6"><a href="#cb40-6"></a> m =<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb40-7"><a href="#cb40-7"></a> N =<span class="st"> </span><span class="kw">length</span>(v)</span>
<span id="cb40-8"><a href="#cb40-8"></a> pwr =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb40-9"><a href="#cb40-9"></a> cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb40-10"><a href="#cb40-10"></a> </span>
<span id="cb40-11"><a href="#cb40-11"></a> <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </span>
<span id="cb40-12"><a href="#cb40-12"></a>  sktests =<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb40-13"><a href="#cb40-13"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </span>
<span id="cb40-14"><a href="#cb40-14"></a>   x =<span class="st"> </span><span class="kw">rt</span>(n,v[j])</span>
<span id="cb40-15"><a href="#cb40-15"></a>   sktests[i] =<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb40-16"><a href="#cb40-16"></a>  }</span>
<span id="cb40-17"><a href="#cb40-17"></a>  pwr[j] =<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb40-18"><a href="#cb40-18"></a> }</span>
<span id="cb40-19"><a href="#cb40-19"></a> se =<span class="st"> </span><span class="kw">sqrt</span>(pwr<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) </span>
<span id="cb40-20"><a href="#cb40-20"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">pwr =</span> pwr,<span class="dt">se =</span> se))</span>
<span id="cb40-21"><a href="#cb40-21"></a>}</span>
<span id="cb40-22"><a href="#cb40-22"></a></span>
<span id="cb40-23"><a href="#cb40-23"></a>v =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>)</span>
<span id="cb40-24"><a href="#cb40-24"></a>pwr =<span class="st"> </span><span class="kw">pwr_t</span>(v)<span class="op">$</span>pwr</span>
<span id="cb40-25"><a href="#cb40-25"></a>se =<span class="st"> </span><span class="kw">pwr_t</span>(v)<span class="op">$</span>se</span>
<span id="cb40-26"><a href="#cb40-26"></a><span class="co"># plot the power</span></span>
<span id="cb40-27"><a href="#cb40-27"></a><span class="kw">plot</span>(v, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;v&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;pwr&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb40-28"><a href="#cb40-28"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.1</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb40-29"><a href="#cb40-29"></a><span class="kw">lines</span>(v, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">4</span>)</span>
<span id="cb40-30"><a href="#cb40-30"></a><span class="kw">lines</span>(v, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The results are different for heavy-tailed symmetric alternatives. For t distribution, the empirical power is always bigger than 0.1 and it decreases to 0.1 with the increase of v.</p>
</div>
<div id="section-5" class="section level3">
<h3>6.8</h3>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level $ 0.055 $ Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb41-2"><a href="#cb41-2"></a>        X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb41-3"><a href="#cb41-3"></a>        Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb41-4"><a href="#cb41-4"></a>        outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb41-5"><a href="#cb41-5"></a>        outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb41-6"><a href="#cb41-6"></a>        <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb41-7"><a href="#cb41-7"></a>}</span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb41-9"><a href="#cb41-9"></a>alpha.hat &lt;-<span class="st"> </span><span class="fl">0.055</span></span>
<span id="cb41-10"><a href="#cb41-10"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb41-11"><a href="#cb41-11"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb41-12"><a href="#cb41-12"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb41-13"><a href="#cb41-13"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb41-14"><a href="#cb41-14"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb41-15"><a href="#cb41-15"></a>result &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="kw">length</span>(n), <span class="dv">2</span>)</span>
<span id="cb41-16"><a href="#cb41-16"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb41-17"><a href="#cb41-17"></a>  ni &lt;-<span class="st"> </span>n[i]</span>
<span id="cb41-18"><a href="#cb41-18"></a>  tests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb41-19"><a href="#cb41-19"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(ni, mu1, sigma1)</span>
<span id="cb41-20"><a href="#cb41-20"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(ni, mu2, sigma2)</span>
<span id="cb41-21"><a href="#cb41-21"></a>    Fp &lt;-<span class="st"> </span><span class="kw">var.test</span>(x, y)<span class="op">$</span>p.value</span>
<span id="cb41-22"><a href="#cb41-22"></a>    Ftest &lt;-<span class="st"> </span><span class="kw">as.integer</span>(Fp <span class="op">&lt;=</span><span class="st"> </span>alpha.hat)</span>
<span id="cb41-23"><a href="#cb41-23"></a>    <span class="kw">c</span>(<span class="kw">count5test</span>(x, y), Ftest)</span>
<span id="cb41-24"><a href="#cb41-24"></a>    })</span>
<span id="cb41-25"><a href="#cb41-25"></a>  result[i, ] &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(tests)</span>
<span id="cb41-26"><a href="#cb41-26"></a>}</span>
<span id="cb41-27"><a href="#cb41-27"></a><span class="kw">data.frame</span>(<span class="dt">n=</span>n, <span class="dt">C5=</span>result[, <span class="dv">1</span>], <span class="dt">Fp=</span>result[, <span class="dv">2</span>])</span></code></pre></div>
<pre><code>##      n    C5    Fp
## 1   10 0.102 0.205
## 2   20 0.334 0.416
## 3   50 0.674 0.812
## 4  100 0.846 0.981
## 5  500 0.992 1.000
## 6 1000 0.997 1.000</code></pre>
<p>The simulation results suggest that the F-test for equal variance is more powerful in this case, for all sample sizes compared.</p>
</div>
<div id="c" class="section level3">
<h3>6.C</h3>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\beta_{1,d}=E[(X-\mu)^T \Sigma^{-1}(Y-\mu)]^3\]</span> Under normality,<span class="math inline">\(\beta_{1,d}=0\)</span> . The multivariate skewness statistic is <span class="math display">\[b_{1,d}=\frac{1}{n^2} \sum_{i,j=1}^n {((X_i-\bar{X})^T \hat{\Sigma}^{-1} (X_j-\bar{X}))^3}\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span>is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(\frac{nb_{1,d}}{6}\)</span> is chisquared with <span class="math inline">\(\frac{d(d + 1)(d + 2)}{6}\)</span> degrees of freedom.</p>
<p>We first repeat Example 6.8 which evaluate t1e rate of Mardia’s multivariate skewness test. In our simulation we generate variables following <span class="math inline">\(N(\mu,\Sigma)\)</span>, where: <span class="math display">\[\mu=(0,0,0)^{T} , \Sigma=\left( \begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \end{array} \right).\]</span></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb43-2"><a href="#cb43-2"></a>Mardia&lt;-<span class="cf">function</span>(mydata){</span>
<span id="cb43-3"><a href="#cb43-3"></a>  n=<span class="kw">nrow</span>(mydata)</span>
<span id="cb43-4"><a href="#cb43-4"></a>  c=<span class="kw">ncol</span>(mydata)</span>
<span id="cb43-5"><a href="#cb43-5"></a>  central&lt;-mydata</span>
<span id="cb43-6"><a href="#cb43-6"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>c){</span>
<span id="cb43-7"><a href="#cb43-7"></a>    central[,i]&lt;-mydata[,i]<span class="op">-</span><span class="kw">mean</span>(mydata[,i])</span>
<span id="cb43-8"><a href="#cb43-8"></a>  }</span>
<span id="cb43-9"><a href="#cb43-9"></a>  sigmah&lt;-<span class="kw">t</span>(central)<span class="op">%*%</span>central<span class="op">/</span>n</span>
<span id="cb43-10"><a href="#cb43-10"></a>  a&lt;-central<span class="op">%*%</span><span class="kw">solve</span>(sigmah)<span class="op">%*%</span><span class="kw">t</span>(central)</span>
<span id="cb43-11"><a href="#cb43-11"></a>  b&lt;-<span class="kw">sum</span>(<span class="kw">colSums</span>(a<span class="op">^</span>{<span class="dv">3</span>}))<span class="op">/</span>(n<span class="op">*</span>n)</span>
<span id="cb43-12"><a href="#cb43-12"></a>  test&lt;-n<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span></span>
<span id="cb43-13"><a href="#cb43-13"></a>  chi&lt;-<span class="kw">qchisq</span>(<span class="fl">0.95</span>,c<span class="op">*</span>(c<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(c<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb43-14"><a href="#cb43-14"></a>  <span class="kw">as.integer</span>(test<span class="op">&gt;</span>chi)</span>
<span id="cb43-15"><a href="#cb43-15"></a>}</span>
<span id="cb43-16"><a href="#cb43-16"></a></span>
<span id="cb43-17"><a href="#cb43-17"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb43-18"><a href="#cb43-18"></a>mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb43-19"><a href="#cb43-19"></a>sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb43-20"><a href="#cb43-20"></a>m=<span class="dv">1000</span></span>
<span id="cb43-21"><a href="#cb43-21"></a>n&lt;-<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)</span>
<span id="cb43-22"><a href="#cb43-22"></a><span class="co">#m: number of replicates; n: sample size</span></span>
<span id="cb43-23"><a href="#cb43-23"></a>a=<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb43-24"><a href="#cb43-24"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb43-25"><a href="#cb43-25"></a>  a[i]=<span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb43-26"><a href="#cb43-26"></a>    mydata &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i],mu,sigma) </span>
<span id="cb43-27"><a href="#cb43-27"></a>    <span class="kw">Mardia</span>(mydata)</span>
<span id="cb43-28"><a href="#cb43-28"></a>  }))</span>
<span id="cb43-29"><a href="#cb43-29"></a>}</span></code></pre></div>
<p>We calculate the t1e when the sample size is 10, 20, 30, 50, 100, 500:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">print</span>(a)</span></code></pre></div>
<pre><code>## [1] 0.001 0.017 0.036 0.049 0.046 0.054</code></pre>
<p>From the result we can see that t1e rate is close to 0.05 after the sample size is large than 50.</p>
<p>We further repeat Example 6.8 which evaluate the power of Mardia’s multivariate skewness test under distribution <span class="math inline">\((1-\epsilon)N(\mu_{1},\Sigma_{1})+\epsilon N(\mu_{2},\Sigma_{2})\)</span>, where: <span class="math display">\[\mu_{1}=\mu_{2}=(0,0,0)^{T}, \Sigma_{1}=\left( \begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \end{array} \right)
\Sigma_{2}=\left( \begin{array}{ccc}
100 &amp; 0 &amp; 0 \\
0 &amp; 100 &amp; 0 \\
0 &amp; 0 &amp; 100 \end{array} \right).\]</span></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="kw">set.seed</span>(<span class="dv">7912</span>)</span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="kw">set.seed</span>(<span class="dv">7912</span>)</span>
<span id="cb46-4"><a href="#cb46-4"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb46-5"><a href="#cb46-5"></a>sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb46-6"><a href="#cb46-6"></a>sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb46-7"><a href="#cb46-7"></a>sigma=<span class="kw">list</span>(sigma1,sigma2)</span>
<span id="cb46-8"><a href="#cb46-8"></a>m=<span class="dv">100</span></span>
<span id="cb46-9"><a href="#cb46-9"></a>n=<span class="dv">50</span></span>
<span id="cb46-10"><a href="#cb46-10"></a><span class="co">#m: number of replicates; n: sample size</span></span>
<span id="cb46-11"><a href="#cb46-11"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.06</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb46-12"><a href="#cb46-12"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb46-13"><a href="#cb46-13"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb46-14"><a href="#cb46-14"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb46-15"><a href="#cb46-15"></a>  e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb46-16"><a href="#cb46-16"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb46-17"><a href="#cb46-17"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb46-18"><a href="#cb46-18"></a>    index=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb46-19"><a href="#cb46-19"></a>    mydata&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb46-20"><a href="#cb46-20"></a>    <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb46-21"><a href="#cb46-21"></a>      <span class="cf">if</span>(index[t]<span class="op">==</span><span class="dv">1</span>) mydata[t,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>,mu1,sigma1) </span>
<span id="cb46-22"><a href="#cb46-22"></a>      <span class="cf">else</span> mydata[t,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>,mu2,sigma2)</span>
<span id="cb46-23"><a href="#cb46-23"></a>    }</span>
<span id="cb46-24"><a href="#cb46-24"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">Mardia</span>(mydata)</span>
<span id="cb46-25"><a href="#cb46-25"></a>  }</span>
<span id="cb46-26"><a href="#cb46-26"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb46-27"><a href="#cb46-27"></a>}</span>
<span id="cb46-28"><a href="#cb46-28"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb46-29"><a href="#cb46-29"></a>     <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb46-30"><a href="#cb46-30"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb46-31"><a href="#cb46-31"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb46-32"><a href="#cb46-32"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb46-33"><a href="#cb46-33"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When <span class="math inline">\(\epsilon=0\)</span> or <span class="math inline">\(\epsilon=1\)</span> the distribution is multinormal, when <span class="math inline">\(0\leq \epsilon \leq 1\)</span> the empirical power of the test is greater than 0.05 and highest(close to 1) when <span class="math inline">\(0.1\leq \epsilon \leq 0.3\)</span>.</p>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<ul>
<li>What is the corresponding hypothesis test problem?</li>
<li>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</li>
<li>What information is needed to test your hypothesis?</li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Denote the powers of two methods as <span class="math inline">\(pwr_{1}\)</span> and <span class="math inline">\(pwr_{2}\)</span>, then the corresponding hypothesis test problem is: <span class="math display">\[H_{0}: pwr_{1}=pwr_{2} \leftrightarrow H_{1}: pwr_{1}\not=pwr_{2}.\]</span></p></li>
<li><p>As the p-value of two methods for the same sample is not independent, we can not apply the two-sample t-test. For the z-test and paired-t test, when the sample size is large, we have the mean value of significance test follows a normal distribution, thus these two methods can be used in the approximate level. McNemar test is good at dealing with this case as it doesn’t need to know the distribution.</p></li>
<li><p>For these test, what we already know is the number of experiments and the value of power(the probability that we reject the null hypothesis correctly). To conduct this test, we also need to know the significance of both methods for each sample.</p></li>
</ol>
</div>
</div>
<div id="homework-2020-11-03" class="section level2">
<h2>homework 2020-11-03</h2>
<div id="section-6" class="section level3">
<h3>7.1</h3>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">library</span>(<span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb47-2"><a href="#cb47-2"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</span>
<span id="cb47-3"><a href="#cb47-3"></a>theta_hat &lt;-<span class="st"> </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT, law<span class="op">$</span>GPA)</span>
<span id="cb47-4"><a href="#cb47-4"></a>theta_jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb47-5"><a href="#cb47-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb47-6"><a href="#cb47-6"></a>  x &lt;-<span class="st"> </span>scor[<span class="op">-</span>i,]</span>
<span id="cb47-7"><a href="#cb47-7"></a>  theta_jack[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT[<span class="op">-</span>i],law<span class="op">$</span>GPA[<span class="op">-</span>i])</span>
<span id="cb47-8"><a href="#cb47-8"></a>}</span>
<span id="cb47-9"><a href="#cb47-9"></a>bias_jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta_jack)<span class="op">-</span>theta_hat)</span>
<span id="cb47-10"><a href="#cb47-10"></a>se_jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta_jack<span class="op">-</span><span class="kw">mean</span>(theta_jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb47-11"><a href="#cb47-11"></a><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">bias_jack=</span>bias_jack,<span class="dt">se_jack=</span>se_jack),<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## bias_jack   se_jack 
##   -0.0069    0.1467</code></pre>
</div>
<div id="section-7" class="section level3">
<h3>7.5</h3>
<p>Refer to Exercise 7.4. Compute <span class="math inline">\(95%\)</span> bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb49-3"><a href="#cb49-3"></a>aircondit &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(aircondit)</span>
<span id="cb49-4"><a href="#cb49-4"></a>boot.mean &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">mean</span>(x[i])</span>
<span id="cb49-5"><a href="#cb49-5"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(aircondit, <span class="dt">statistic=</span>boot.mean, <span class="dt">R=</span><span class="dv">2000</span>)</span>
<span id="cb49-6"><a href="#cb49-6"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.4, 181.4 )   ( 24.3, 170.1 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.1, 191.9 )   ( 55.6, 224.7 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
</div>
<div id="section-8" class="section level3">
<h3>7.8</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb51-3"><a href="#cb51-3"></a></span>
<span id="cb51-4"><a href="#cb51-4"></a>n =<span class="st"> </span><span class="kw">nrow</span>(scor)</span>
<span id="cb51-5"><a href="#cb51-5"></a>lambda_hat =<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</span>
<span id="cb51-6"><a href="#cb51-6"></a>theta_hat =<span class="st"> </span>lambda_hat[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda_hat)</span>
<span id="cb51-7"><a href="#cb51-7"></a>theta_j =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb51-8"><a href="#cb51-8"></a></span>
<span id="cb51-9"><a href="#cb51-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb51-10"><a href="#cb51-10"></a></span>
<span id="cb51-11"><a href="#cb51-11"></a>x =<span class="st"> </span>scor [<span class="op">-</span>i,]</span>
<span id="cb51-12"><a href="#cb51-12"></a>lambda =<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values</span>
<span id="cb51-13"><a href="#cb51-13"></a>theta_j[i] =<span class="st"> </span>lambda[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda)</span>
<span id="cb51-14"><a href="#cb51-14"></a></span>
<span id="cb51-15"><a href="#cb51-15"></a>}</span>
<span id="cb51-16"><a href="#cb51-16"></a><span class="co">#estimated bias of theta_hat</span></span>
<span id="cb51-17"><a href="#cb51-17"></a>bias_jack =<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta_j)<span class="op">-</span>theta_hat)</span>
<span id="cb51-18"><a href="#cb51-18"></a><span class="co">#estimated se of theta_hat</span></span>
<span id="cb51-19"><a href="#cb51-19"></a>se_jack =<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="kw">var</span>(theta_j)<span class="op">/</span>n)</span>
<span id="cb51-20"><a href="#cb51-20"></a></span>
<span id="cb51-21"><a href="#cb51-21"></a><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">bias_jack=</span>bias_jack,<span class="dt">se_jack=</span>se_jack),<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## bias_jack   se_jack 
##    0.0011    0.0496</code></pre>
</div>
<div id="section-9" class="section level3">
<h3>7.11</h3>
<p>In Example 7.18, leave-one-out (<span class="math inline">\(n\)</span>-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">library</span>(DAAG)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;DAAG&#39;是用R版本4.0.3 来建造的</code></pre>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">attach</span>(ironslag)</span>
<span id="cb60-2"><a href="#cb60-2"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic)</span>
<span id="cb60-3"><a href="#cb60-3"></a>e1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb60-4"><a href="#cb60-4"></a>e2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb60-5"><a href="#cb60-5"></a>e3 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb60-6"><a href="#cb60-6"></a>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb60-7"><a href="#cb60-7"></a>count &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb60-8"><a href="#cb60-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>))</span>
<span id="cb60-9"><a href="#cb60-9"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n) {</span>
<span id="cb60-10"><a href="#cb60-10"></a>    count &lt;-<span class="st"> </span>count<span class="op">+</span><span class="dv">1</span></span>
<span id="cb60-11"><a href="#cb60-11"></a>    y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span><span class="kw">c</span>(i,j)]</span>
<span id="cb60-12"><a href="#cb60-12"></a>    x &lt;-<span class="st"> </span>chemical[<span class="op">-</span><span class="kw">c</span>(i,j)]</span>
<span id="cb60-13"><a href="#cb60-13"></a>    </span>
<span id="cb60-14"><a href="#cb60-14"></a>    P1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x)</span>
<span id="cb60-15"><a href="#cb60-15"></a>    y1_<span class="dv">1</span> &lt;-<span class="st"> </span>chemical[i]<span class="op">*</span>P1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>P1<span class="op">$</span>coef[<span class="dv">1</span>]</span>
<span id="cb60-16"><a href="#cb60-16"></a>    y1_<span class="dv">2</span> &lt;-<span class="st"> </span>chemical[j]<span class="op">*</span>P1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>P1<span class="op">$</span>coef[<span class="dv">1</span>]</span>
<span id="cb60-17"><a href="#cb60-17"></a>    e1[count] &lt;-<span class="st"> </span>(magnetic[i]<span class="op">-</span>y1_<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>y1_<span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb60-18"><a href="#cb60-18"></a>    </span>
<span id="cb60-19"><a href="#cb60-19"></a>    P2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb60-20"><a href="#cb60-20"></a>    y2_<span class="dv">1</span> &lt;-<span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] <span class="op">+</span><span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[i]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb60-21"><a href="#cb60-21"></a>    y2_<span class="dv">2</span> &lt;-<span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j] <span class="op">+</span><span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[j]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb60-22"><a href="#cb60-22"></a>    e2[count] &lt;-<span class="st"> </span>(magnetic[i]<span class="op">-</span>y2_<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>y2_<span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb60-23"><a href="#cb60-23"></a>    </span>
<span id="cb60-24"><a href="#cb60-24"></a>    P3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y)<span class="op">~</span>x)</span>
<span id="cb60-25"><a href="#cb60-25"></a>    y3_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(P3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i])</span>
<span id="cb60-26"><a href="#cb60-26"></a>    y3_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(P3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j])</span>
<span id="cb60-27"><a href="#cb60-27"></a>    e3[count] &lt;-<span class="st"> </span>(magnetic[i]<span class="op">-</span>y3_<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>y3_<span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb60-28"><a href="#cb60-28"></a>    </span>
<span id="cb60-29"><a href="#cb60-29"></a>    P4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y)<span class="op">~</span><span class="kw">log</span>(x))</span>
<span id="cb60-30"><a href="#cb60-30"></a>    y4_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(P4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[i]))</span>
<span id="cb60-31"><a href="#cb60-31"></a>    y4_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(P4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[j]))</span>
<span id="cb60-32"><a href="#cb60-32"></a>    e4[count] &lt;-<span class="st"> </span>(magnetic[i]<span class="op">-</span>y4_<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>y4_<span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb60-33"><a href="#cb60-33"></a>  }</span>
<span id="cb60-34"><a href="#cb60-34"></a></span>
<span id="cb60-35"><a href="#cb60-35"></a>e =<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(e1)<span class="op">/</span><span class="dv">2</span>,<span class="kw">mean</span>(e2)<span class="op">/</span><span class="dv">2</span>,<span class="kw">mean</span>(e3)<span class="op">/</span><span class="dv">2</span>,<span class="kw">mean</span>(e4)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb60-36"><a href="#cb60-36"></a><span class="kw">matrix</span>(e, <span class="dt">nrow=</span><span class="dv">1</span>,</span>
<span id="cb60-37"><a href="#cb60-37"></a>       <span class="dt">dimnames=</span><span class="kw">list</span>(<span class="st">&quot;prediction error&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Linear&quot;</span>,<span class="st">&quot;Quadratic&quot;</span>,<span class="st">&quot; Exponential&quot;</span>,<span class="st">&quot;Log-Log&quot;</span>)))</span></code></pre></div>
<pre><code>##                    Linear Quadratic  Exponential  Log-Log
## prediction error 19.57227  17.87018     18.45491 20.46718</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="kw">detach</span>(ironslag)</span></code></pre></div>
</div>
</div>
<div id="homework-2020-11-10" class="section level2">
<h2>homework 2020-11-10</h2>
<div id="section-10" class="section level3">
<h3>8.3</h3>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb63-2"><a href="#cb63-2"></a></span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="co"># Count Five test</span></span>
<span id="cb63-4"><a href="#cb63-4"></a>count5test =<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb63-5"><a href="#cb63-5"></a>X =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb63-6"><a href="#cb63-6"></a>Y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb63-7"><a href="#cb63-7"></a>outx =<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb63-8"><a href="#cb63-8"></a>outy =<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb63-9"><a href="#cb63-9"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb63-10"><a href="#cb63-10"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb63-11"><a href="#cb63-11"></a>}</span>
<span id="cb63-12"><a href="#cb63-12"></a><span class="co"># Count Five test permutation</span></span>
<span id="cb63-13"><a href="#cb63-13"></a>count5test_permutation =<span class="st"> </span><span class="cf">function</span>(z) {</span>
<span id="cb63-14"><a href="#cb63-14"></a></span>
<span id="cb63-15"><a href="#cb63-15"></a>n =<span class="st"> </span><span class="kw">length</span>(z)</span>
<span id="cb63-16"><a href="#cb63-16"></a>x =<span class="st"> </span>z[<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>)]</span>
<span id="cb63-17"><a href="#cb63-17"></a>y =<span class="st"> </span>z[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>))]</span>
<span id="cb63-18"><a href="#cb63-18"></a>X =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb63-19"><a href="#cb63-19"></a>Y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb63-20"><a href="#cb63-20"></a>outx =<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y)) </span>
<span id="cb63-21"><a href="#cb63-21"></a>outy =<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb63-22"><a href="#cb63-22"></a><span class="co"># return 1 (reject) or 0 (do not reject H0) </span></span>
<span id="cb63-23"><a href="#cb63-23"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb63-24"><a href="#cb63-24"></a>}</span>
<span id="cb63-25"><a href="#cb63-25"></a>permutation =<span class="st"> </span><span class="cf">function</span>(z,R) {</span>
<span id="cb63-26"><a href="#cb63-26"></a>  n =<span class="st"> </span><span class="kw">length</span>(z)</span>
<span id="cb63-27"><a href="#cb63-27"></a>  out =<span class="st"> </span><span class="kw">numeric</span>(R)</span>
<span id="cb63-28"><a href="#cb63-28"></a>  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="st"> </span>R){</span>
<span id="cb63-29"><a href="#cb63-29"></a>      p =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n ,n ,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb63-30"><a href="#cb63-30"></a>      out[r] =<span class="st"> </span><span class="kw">count5test_permutation</span>(z[p])</span>
<span id="cb63-31"><a href="#cb63-31"></a>  }</span>
<span id="cb63-32"><a href="#cb63-32"></a>  <span class="kw">sum</span>(out)<span class="op">/</span>R</span>
<span id="cb63-33"><a href="#cb63-33"></a>}              </span>
<span id="cb63-34"><a href="#cb63-34"></a></span>
<span id="cb63-35"><a href="#cb63-35"></a></span>
<span id="cb63-36"><a href="#cb63-36"></a>n1 =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb63-37"><a href="#cb63-37"></a>n2 =<span class="st"> </span><span class="dv">50</span></span>
<span id="cb63-38"><a href="#cb63-38"></a>mu1 =<span class="st"> </span>mu2 =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb63-39"><a href="#cb63-39"></a>sigma1 =<span class="st"> </span>sigma2 =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb63-40"><a href="#cb63-40"></a>m =<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb63-41"><a href="#cb63-41"></a></span>
<span id="cb63-42"><a href="#cb63-42"></a>alphahat1 =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb63-43"><a href="#cb63-43"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb63-44"><a href="#cb63-44"></a>y =<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb63-45"><a href="#cb63-45"></a>x =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean</span></span>
<span id="cb63-46"><a href="#cb63-46"></a>y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb63-47"><a href="#cb63-47"></a><span class="kw">count5test</span>(x, y)</span>
<span id="cb63-48"><a href="#cb63-48"></a>}))</span>
<span id="cb63-49"><a href="#cb63-49"></a>alphahat2 =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb63-50"><a href="#cb63-50"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb63-51"><a href="#cb63-51"></a>y =<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb63-52"><a href="#cb63-52"></a>x =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean </span></span>
<span id="cb63-53"><a href="#cb63-53"></a>y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb63-54"><a href="#cb63-54"></a>z =<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb63-55"><a href="#cb63-55"></a><span class="kw">permutation</span>(z,<span class="dv">1000</span>) </span>
<span id="cb63-56"><a href="#cb63-56"></a>})<span class="op">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb63-57"><a href="#cb63-57"></a></span>
<span id="cb63-58"><a href="#cb63-58"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">count5test=</span>alphahat1,<span class="dt">count5test_permutation=</span>alphahat2),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##             count5test count5test_permutation 
##                  0.300                  0.039</code></pre>
</div>
<div id="question" class="section level3">
<h3>Question</h3>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ol style="list-style-type: decimal">
<li><p>Unequal variances and equal expectations;</p></li>
<li><p>Unequal variances and unequal expectations;</p></li>
<li><p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions);</p></li>
<li><p>Unbalanced samples (say, 1 case versus 10 controls).</p></li>
</ol>
<p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
<ol style="list-style-type: decimal">
<li>We use the following code to help conduct NN method:</li>
</ol>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="kw">library</span>(RANN)</span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb65-3"><a href="#cb65-3"></a><span class="kw">library</span>(Ball)</span>
<span id="cb65-4"><a href="#cb65-4"></a><span class="kw">library</span>(energy)</span>
<span id="cb65-5"><a href="#cb65-5"></a><span class="kw">library</span>(MASS)</span>
<span id="cb65-6"><a href="#cb65-6"></a></span>
<span id="cb65-7"><a href="#cb65-7"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb65-8"><a href="#cb65-8"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb65-9"><a href="#cb65-9"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb65-10"><a href="#cb65-10"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb65-11"><a href="#cb65-11"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb65-12"><a href="#cb65-12"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb65-13"><a href="#cb65-13"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb65-14"><a href="#cb65-14"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb65-15"><a href="#cb65-15"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb65-16"><a href="#cb65-16"></a>}</span>
<span id="cb65-17"><a href="#cb65-17"></a></span>
<span id="cb65-18"><a href="#cb65-18"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb65-19"><a href="#cb65-19"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb65-20"><a href="#cb65-20"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb65-21"><a href="#cb65-21"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb65-22"><a href="#cb65-22"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb65-23"><a href="#cb65-23"></a>}</span></code></pre></div>
<p>Unequal variances and equal expectations: We generate variables from two distributions <span class="math inline">\(N(\mu_{1},\Sigma_{1})\)</span> and <span class="math inline">\(N(\mu_{2},\Sigma_{2})\)</span> where: <span class="math display">\[\mu_{1}=\mu_{2}=(0,0,0)^{T}, \Sigma_{1}=\left( \begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \end{array} \right)
\Sigma_{2}=\left( \begin{array}{ccc}
2 &amp; 0 &amp; 0 \\
0 &amp; 3 &amp; 0 \\
0 &amp; 0 &amp; 4 \end{array} \right).\]</span></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb66-2"><a href="#cb66-2"></a>sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb66-3"><a href="#cb66-3"></a>mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb66-4"><a href="#cb66-4"></a>sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb66-5"><a href="#cb66-5"></a>n1=n2=<span class="dv">20</span></span>
<span id="cb66-6"><a href="#cb66-6"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </span>
<span id="cb66-7"><a href="#cb66-7"></a>N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb66-8"><a href="#cb66-8"></a>k=<span class="dv">3</span></span>
<span id="cb66-9"><a href="#cb66-9"></a>R=<span class="dv">999</span></span>
<span id="cb66-10"><a href="#cb66-10"></a>m=<span class="dv">100</span></span>
<span id="cb66-11"><a href="#cb66-11"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb66-12"><a href="#cb66-12"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb66-13"><a href="#cb66-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb66-14"><a href="#cb66-14"></a>  mydata1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1,mu1,sigma1)</span>
<span id="cb66-15"><a href="#cb66-15"></a>  mydata2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2,mu2,sigma2)</span>
<span id="cb66-16"><a href="#cb66-16"></a>  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</span>
<span id="cb66-17"><a href="#cb66-17"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</span>
<span id="cb66-18"><a href="#cb66-18"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb66-19"><a href="#cb66-19"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</span>
<span id="cb66-20"><a href="#cb66-20"></a>}</span>
<span id="cb66-21"><a href="#cb66-21"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb66-22"><a href="#cb66-22"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb66-23"><a href="#cb66-23"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.35 0.28 0.88</code></pre>
<p>From the result we can see that while the ball method shows a performance, both NN and energy method perform poorly. Besides, the power of NN method is slightly higher than the energy method.</p>
<ol start="2" style="list-style-type: decimal">
<li>Unequal variances and unequal expectations: We generate variables from two distributions <span class="math inline">\(N(\mu_{1},\Sigma_{1})\)</span> and <span class="math inline">\(N(\mu_{2},\Sigma_{2})\)</span> where: <span class="math display">\[\mu_{1}=(0,0,0)^{T}, \mu_{2}=(0.5,-0.5,0.5)^{T}, \Sigma_{1}=\left( \begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \end{array} \right)
\Sigma_{2}=\left( \begin{array}{ccc}
2 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 \\
0 &amp; 0 &amp; 2 \end{array} \right).\]</span></li>
</ol>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb68-2"><a href="#cb68-2"></a>sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb68-3"><a href="#cb68-3"></a>mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>)</span>
<span id="cb68-4"><a href="#cb68-4"></a>sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb68-5"><a href="#cb68-5"></a>n1=n2=<span class="dv">20</span></span>
<span id="cb68-6"><a href="#cb68-6"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </span>
<span id="cb68-7"><a href="#cb68-7"></a>N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb68-8"><a href="#cb68-8"></a>k=<span class="dv">3</span></span>
<span id="cb68-9"><a href="#cb68-9"></a>R=<span class="dv">999</span></span>
<span id="cb68-10"><a href="#cb68-10"></a>m=<span class="dv">100</span></span>
<span id="cb68-11"><a href="#cb68-11"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb68-12"><a href="#cb68-12"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb68-13"><a href="#cb68-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb68-14"><a href="#cb68-14"></a>  mydata1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1,mu1,sigma1)</span>
<span id="cb68-15"><a href="#cb68-15"></a>  mydata2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2,mu2,sigma2)</span>
<span id="cb68-16"><a href="#cb68-16"></a>  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</span>
<span id="cb68-17"><a href="#cb68-17"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</span>
<span id="cb68-18"><a href="#cb68-18"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb68-19"><a href="#cb68-19"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</span>
<span id="cb68-20"><a href="#cb68-20"></a>}</span>
<span id="cb68-21"><a href="#cb68-21"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb68-22"><a href="#cb68-22"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb68-23"><a href="#cb68-23"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.33 0.58 0.76</code></pre>
<p>The result shows that the ball method is still the one performs the best, while the NN method is the worst one.</p>
<ol start="3" style="list-style-type: decimal">
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
</ol>
<p>We first generate variables from two distinct t distribution and use the three methods to test it:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>n1=n2=<span class="dv">20</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </span>
<span id="cb70-3"><a href="#cb70-3"></a>N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb70-4"><a href="#cb70-4"></a>k=<span class="dv">3</span></span>
<span id="cb70-5"><a href="#cb70-5"></a>R=<span class="dv">999</span></span>
<span id="cb70-6"><a href="#cb70-6"></a>m=<span class="dv">100</span></span>
<span id="cb70-7"><a href="#cb70-7"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb70-8"><a href="#cb70-8"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb70-9"><a href="#cb70-9"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb70-10"><a href="#cb70-10"></a>  mydata1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rt</span>(n1,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb70-11"><a href="#cb70-11"></a>  mydata2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rt</span>(n2,<span class="dv">2</span>,<span class="dv">5</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb70-12"><a href="#cb70-12"></a>  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</span>
<span id="cb70-13"><a href="#cb70-13"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</span>
<span id="cb70-14"><a href="#cb70-14"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb70-15"><a href="#cb70-15"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</span>
<span id="cb70-16"><a href="#cb70-16"></a>}</span>
<span id="cb70-17"><a href="#cb70-17"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb70-18"><a href="#cb70-18"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb70-19"><a href="#cb70-19"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.66 0.57 0.79</code></pre>
<p>The result suggests that for t distributions, the ball method still performs the best, followed by the NN method. In this case the difference between these methods is not so large.</p>
<p>We then generate variables from two distinct bimodel distributions: <span class="math inline">\(\frac{1}{2}N(0,1)+\frac{1}{2}N(0,2)\)</span> and <span class="math inline">\(\frac{1}{2}N(1,4)+\frac{1}{2}N(1,3)\)</span>, and use the three methods to test it:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>n1=n2=<span class="dv">20</span></span>
<span id="cb72-2"><a href="#cb72-2"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </span>
<span id="cb72-3"><a href="#cb72-3"></a>N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb72-4"><a href="#cb72-4"></a>k=<span class="dv">3</span></span>
<span id="cb72-5"><a href="#cb72-5"></a>R=<span class="dv">999</span></span>
<span id="cb72-6"><a href="#cb72-6"></a>m=<span class="dv">100</span></span>
<span id="cb72-7"><a href="#cb72-7"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb72-8"><a href="#cb72-8"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb72-9"><a href="#cb72-9"></a>rbimodel&lt;-<span class="cf">function</span>(n,mu1,mu2,sd1,sd2){</span>
<span id="cb72-10"><a href="#cb72-10"></a>  index=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</span>
<span id="cb72-11"><a href="#cb72-11"></a>  x=<span class="kw">numeric</span>(n)</span>
<span id="cb72-12"><a href="#cb72-12"></a>  index1&lt;-<span class="kw">which</span>(index<span class="op">==</span><span class="dv">1</span>)</span>
<span id="cb72-13"><a href="#cb72-13"></a>  x[index1]&lt;-<span class="kw">rnorm</span>(<span class="kw">length</span>(index1), mu1, sd1)</span>
<span id="cb72-14"><a href="#cb72-14"></a>  index2&lt;-<span class="kw">which</span>(index<span class="op">==</span><span class="dv">2</span>)</span>
<span id="cb72-15"><a href="#cb72-15"></a>  x[index2]&lt;-<span class="kw">rnorm</span>(<span class="kw">length</span>(index2), mu2, sd2)</span>
<span id="cb72-16"><a href="#cb72-16"></a>  <span class="kw">return</span>(x)</span>
<span id="cb72-17"><a href="#cb72-17"></a>}</span>
<span id="cb72-18"><a href="#cb72-18"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb72-19"><a href="#cb72-19"></a>  mydata1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rbimodel</span>(n1,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb72-20"><a href="#cb72-20"></a>  mydata2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rbimodel</span>(n2,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb72-21"><a href="#cb72-21"></a>  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</span>
<span id="cb72-22"><a href="#cb72-22"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</span>
<span id="cb72-23"><a href="#cb72-23"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb72-24"><a href="#cb72-24"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</span>
<span id="cb72-25"><a href="#cb72-25"></a>}</span>
<span id="cb72-26"><a href="#cb72-26"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb72-27"><a href="#cb72-27"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb72-28"><a href="#cb72-28"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.47 0.59 0.80</code></pre>
<p>The result suggests that for bimodel distributions, the energy method performs better thatn the NN method, while the power of ball method is much higher than the other two methods.</p>
<ol start="4" style="list-style-type: decimal">
<li>Unbalanced samples:</li>
</ol>
<p>In this case we consider the same distribution as (2), although the the number of two samples is unbalaned, where <span class="math inline">\(n_{1}=10, n_{2}=100\)</span>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb74-2"><a href="#cb74-2"></a>sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb74-3"><a href="#cb74-3"></a>mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>)</span>
<span id="cb74-4"><a href="#cb74-4"></a>sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb74-5"><a href="#cb74-5"></a>n1=<span class="dv">10</span></span>
<span id="cb74-6"><a href="#cb74-6"></a>n2=<span class="dv">100</span></span>
<span id="cb74-7"><a href="#cb74-7"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </span>
<span id="cb74-8"><a href="#cb74-8"></a>N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb74-9"><a href="#cb74-9"></a>k=<span class="dv">3</span></span>
<span id="cb74-10"><a href="#cb74-10"></a>R=<span class="dv">999</span></span>
<span id="cb74-11"><a href="#cb74-11"></a>m=<span class="dv">100</span></span>
<span id="cb74-12"><a href="#cb74-12"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb74-13"><a href="#cb74-13"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb74-14"><a href="#cb74-14"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb74-15"><a href="#cb74-15"></a>  mydata1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1,mu1,sigma1)</span>
<span id="cb74-16"><a href="#cb74-16"></a>  mydata2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2,mu2,sigma2)</span>
<span id="cb74-17"><a href="#cb74-17"></a>  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</span>
<span id="cb74-18"><a href="#cb74-18"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</span>
<span id="cb74-19"><a href="#cb74-19"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb74-20"><a href="#cb74-20"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</span>
<span id="cb74-21"><a href="#cb74-21"></a>}</span>
<span id="cb74-22"><a href="#cb74-22"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb74-23"><a href="#cb74-23"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb74-24"><a href="#cb74-24"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.10 0.36 0.73</code></pre>
<p>The result suggest that while the NN and energy methods have a poor performance, the power of ball method still reaches 0.6.</p>
<p>To summarize, the ball method has a better performance over the other two methods in general.</p>
</div>
</div>
<div id="homework-2020-11-17" class="section level2">
<h2>homework 2020-11-17</h2>
<div id="section-11" class="section level3">
<h3>9.4</h3>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="kw">set.seed</span>(<span class="dv">3000</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a></span>
<span id="cb76-3"><a href="#cb76-3"></a>lap_f =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb76-4"><a href="#cb76-4"></a></span>
<span id="cb76-5"><a href="#cb76-5"></a>rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb76-6"><a href="#cb76-6"></a> x =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb76-7"><a href="#cb76-7"></a> x[<span class="dv">1</span>] =<span class="st"> </span>x0</span>
<span id="cb76-8"><a href="#cb76-8"></a> u =<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb76-9"><a href="#cb76-9"></a> k =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb76-10"><a href="#cb76-10"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb76-11"><a href="#cb76-11"></a>  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb76-12"><a href="#cb76-12"></a>  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap_f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap_f</span>(x[i<span class="dv">-1</span>]))) x[i] =<span class="st"> </span>y </span>
<span id="cb76-13"><a href="#cb76-13"></a>  <span class="cf">else</span> {</span>
<span id="cb76-14"><a href="#cb76-14"></a>  x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb76-15"><a href="#cb76-15"></a>  k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb76-16"><a href="#cb76-16"></a>  }</span>
<span id="cb76-17"><a href="#cb76-17"></a> }</span>
<span id="cb76-18"><a href="#cb76-18"></a> <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</span>
<span id="cb76-19"><a href="#cb76-19"></a>}</span>
<span id="cb76-20"><a href="#cb76-20"></a></span>
<span id="cb76-21"><a href="#cb76-21"></a>N =<span class="st"> </span><span class="dv">200</span></span>
<span id="cb76-22"><a href="#cb76-22"></a>sigma =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb76-23"><a href="#cb76-23"></a>x0 =<span class="st"> </span><span class="dv">25</span></span>
<span id="cb76-24"><a href="#cb76-24"></a>rw1 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb76-25"><a href="#cb76-25"></a>rw2 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb76-26"><a href="#cb76-26"></a>rw3 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb76-27"><a href="#cb76-27"></a>rw4 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb76-28"><a href="#cb76-28"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb76-29"><a href="#cb76-29"></a>Rej =<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)</span>
<span id="cb76-30"><a href="#cb76-30"></a>Acc =<span class="st"> </span><span class="kw">round</span>((N<span class="op">-</span>Rej)<span class="op">/</span>N,<span class="dv">4</span>)</span>
<span id="cb76-31"><a href="#cb76-31"></a><span class="kw">rownames</span>(Acc) =<span class="st"> &quot;Accept rates&quot;</span></span>
<span id="cb76-32"><a href="#cb76-32"></a><span class="kw">colnames</span>(Acc) =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;sigma&quot;</span>,sigma)</span>
<span id="cb76-33"><a href="#cb76-33"></a>knitr<span class="op">::</span><span class="kw">kable</span>(Acc)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
sigma 0.05
</th>
<th style="text-align:right;">
sigma 0.5
</th>
<th style="text-align:right;">
sigma 2
</th>
<th style="text-align:right;">
sigma 16
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Accept rates
</td>
<td style="text-align:right;">
0.975
</td>
<td style="text-align:right;">
0.835
</td>
<td style="text-align:right;">
0.465
</td>
<td style="text-align:right;">
0.125
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="co">#plot</span></span>
<span id="cb77-2"><a href="#cb77-2"></a>    rw =<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</span>
<span id="cb77-3"><a href="#cb77-3"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb77-4"><a href="#cb77-4"></a>        <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb77-5"><a href="#cb77-5"></a>             <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb77-6"><a href="#cb77-6"></a>             <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</span>
<span id="cb77-7"><a href="#cb77-7"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question2" class="section level3">
<h3>Question2</h3>
<p>Extension 9.4 Use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb78-3"><a href="#cb78-3"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb78-4"><a href="#cb78-4"></a>psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb78-5"><a href="#cb78-5"></a>n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb78-6"><a href="#cb78-6"></a>k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb78-7"><a href="#cb78-7"></a>psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb78-8"><a href="#cb78-8"></a>B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb78-9"><a href="#cb78-9"></a>psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb78-10"><a href="#cb78-10"></a>W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb78-11"><a href="#cb78-11"></a>v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb78-12"><a href="#cb78-12"></a>r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span></span>
<span id="cb78-13"><a href="#cb78-13"></a><span class="kw">return</span>(r.hat)</span>
<span id="cb78-14"><a href="#cb78-14"></a>}</span>
<span id="cb78-15"><a href="#cb78-15"></a></span>
<span id="cb78-16"><a href="#cb78-16"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>    <span class="co"># four chains</span></span>
<span id="cb78-17"><a href="#cb78-17"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>)    <span class="co"># overdispersed initial values</span></span>
<span id="cb78-18"><a href="#cb78-18"></a>N &lt;-<span class="st"> </span><span class="dv">10000</span>    <span class="co"># length of chains</span></span>
<span id="cb78-19"><a href="#cb78-19"></a>b &lt;-<span class="st"> </span><span class="dv">200</span>    <span class="co"># burn-in length</span></span>
<span id="cb78-20"><a href="#cb78-20"></a></span>
<span id="cb78-21"><a href="#cb78-21"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb78-22"><a href="#cb78-22"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb78-23"><a href="#cb78-23"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(<span class="fl">0.5</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb78-24"><a href="#cb78-24"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb78-25"><a href="#cb78-25"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb78-26"><a href="#cb78-26"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb78-27"><a href="#cb78-27"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb78-28"><a href="#cb78-28"></a><span class="cf">for</span> (j <span class="cf">in</span> (<span class="dv">1000</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb78-29"><a href="#cb78-29"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb78-30"><a href="#cb78-30"></a><span class="kw">plot</span>(rhat[(<span class="dv">1000</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=0.5&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb78-31"><a href="#cb78-31"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb79-3"><a href="#cb79-3"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(<span class="dv">1</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb79-4"><a href="#cb79-4"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb79-5"><a href="#cb79-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb79-6"><a href="#cb79-6"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb79-7"><a href="#cb79-7"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb79-8"><a href="#cb79-8"></a><span class="cf">for</span> (j <span class="cf">in</span> (<span class="dv">500</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb79-9"><a href="#cb79-9"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb79-10"><a href="#cb79-10"></a>x2 &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(rhat<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>rhat<span class="op">&lt;</span><span class="fl">1.2</span>))</span>
<span id="cb79-11"><a href="#cb79-11"></a><span class="kw">plot</span>(rhat[(<span class="dv">500</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=1&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb79-12"><a href="#cb79-12"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb80-3"><a href="#cb80-3"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(<span class="dv">4</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb80-4"><a href="#cb80-4"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb80-5"><a href="#cb80-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb80-6"><a href="#cb80-6"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb80-7"><a href="#cb80-7"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb80-8"><a href="#cb80-8"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb80-9"><a href="#cb80-9"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb80-10"><a href="#cb80-10"></a>x3 &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(rhat<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>rhat<span class="op">&lt;</span><span class="fl">1.2</span>))</span>
<span id="cb80-11"><a href="#cb80-11"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=4&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb80-12"><a href="#cb80-12"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb81-3"><a href="#cb81-3"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(<span class="dv">16</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb81-4"><a href="#cb81-4"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb81-5"><a href="#cb81-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb81-6"><a href="#cb81-6"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb81-7"><a href="#cb81-7"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb81-8"><a href="#cb81-8"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb81-9"><a href="#cb81-9"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb81-10"><a href="#cb81-10"></a>x4 &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(rhat<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>rhat<span class="op">&lt;</span><span class="fl">1.2</span>))</span>
<span id="cb81-11"><a href="#cb81-11"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=16&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb81-12"><a href="#cb81-12"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="kw">c</span>(x2,x3,x4)</span></code></pre></div>
<pre><code>## [1] 1016  675  201</code></pre>
<p>From the result, we know that from our simulation:</p>
<ol style="list-style-type: decimal">
<li><p>When <span class="math inline">\(\sigma=0.5\)</span>, the chain don’t converge in the first <span class="math inline">\(N=10000\)</span> iterations based on the criteria <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p></li>
<li><p>When <span class="math inline">\(\sigma=1\)</span>, the chain converges at <span class="math inline">\(N=1956\)</span> iteration based on the criteria <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p></li>
<li><p>When <span class="math inline">\(\sigma=4\)</span>, the chain converges at <span class="math inline">\(N=1454\)</span> iteration based on the criteria <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p></li>
<li><p>When <span class="math inline">\(\sigma=16\)</span>, the chain converges at <span class="math inline">\(N=348\)</span> iteration based on the criteria <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p></li>
</ol>
</div>
<div id="section-12" class="section level3">
<h3>11.4</h3>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[\begin{equation}
S_{k-1}(a)=P(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}})
\end{equation}\]</span> and <span class="math display">\[\begin{equation}
S_k(a)=P(t(k)&gt;\sqrt{\frac{a^2 k}{k+1-a^2}}),
\end{equation}\]</span> for <span class="math inline">\(k = 4 : 25, 100, 500, 1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student <span class="math inline">\(t\)</span> random variable with <span class="math inline">\(k\)</span> degrees of freedom. (These intersection points determine the critical values for a <span class="math inline">\(t\)</span>-test for scale-mixture errors.)</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>k =<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb84-2"><a href="#cb84-2"></a>S =<span class="st"> </span><span class="cf">function</span>(a,k){</span>
<span id="cb84-3"><a href="#cb84-3"></a> ck =<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb84-4"><a href="#cb84-4"></a> <span class="kw">pt</span>(ck,<span class="dt">df=</span>k,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</span>
<span id="cb84-5"><a href="#cb84-5"></a>}</span>
<span id="cb84-6"><a href="#cb84-6"></a></span>
<span id="cb84-7"><a href="#cb84-7"></a>f =<span class="st"> </span><span class="cf">function</span>(a,k){<span class="kw">S</span>(a,k)<span class="op">-</span><span class="kw">S</span>(a,k<span class="dv">-1</span>)}</span>
<span id="cb84-8"><a href="#cb84-8"></a><span class="co">#curve(f(x),xlim = c(0,sqrt(k)))</span></span>
<span id="cb84-9"><a href="#cb84-9"></a>a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dt">by=</span><span class="fl">0.01</span>)</span>
<span id="cb84-10"><a href="#cb84-10"></a><span class="kw">plot</span>(a, <span class="kw">f</span>(a, k[<span class="dv">23</span>]), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="dv">1</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">xlab=</span><span class="st">&quot;a&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;f(a|k)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;f(a) with different k&quot;</span>)</span>
<span id="cb84-11"><a href="#cb84-11"></a><span class="kw">lines</span>(a, <span class="kw">f</span>(a, k[<span class="dv">24</span>]), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb84-12"><a href="#cb84-12"></a><span class="kw">lines</span>(a, <span class="kw">f</span>(a, k[<span class="dv">25</span>]), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">lty=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb84-13"><a href="#cb84-13"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;k=100&quot;</span>, <span class="st">&quot;k=500&quot;</span>, <span class="st">&quot;k=1000&quot;</span>), <span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="co"># So the lower and upper bound in function uniroot should be 1 and 2 respectively</span></span>
<span id="cb85-2"><a href="#cb85-2"></a></span>
<span id="cb85-3"><a href="#cb85-3"></a>solve =<span class="st"> </span><span class="cf">function</span>(k){</span>
<span id="cb85-4"><a href="#cb85-4"></a>  output =<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(a){<span class="kw">S</span>(a,k)<span class="op">-</span><span class="kw">S</span>(a,k<span class="dv">-1</span>)},<span class="dt">lower=</span><span class="dv">1</span>,<span class="dt">upper=</span><span class="dv">2</span>)</span>
<span id="cb85-5"><a href="#cb85-5"></a>  output<span class="op">$</span>root</span>
<span id="cb85-6"><a href="#cb85-6"></a>}</span>
<span id="cb85-7"><a href="#cb85-7"></a></span>
<span id="cb85-8"><a href="#cb85-8"></a>root =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="kw">length</span>(k))</span>
<span id="cb85-9"><a href="#cb85-9"></a></span>
<span id="cb85-10"><a href="#cb85-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</span>
<span id="cb85-11"><a href="#cb85-11"></a>  root[<span class="dv">2</span>,i]=<span class="kw">round</span>(<span class="kw">solve</span>(k[i]),<span class="dv">4</span>)</span>
<span id="cb85-12"><a href="#cb85-12"></a>}</span>
<span id="cb85-13"><a href="#cb85-13"></a></span>
<span id="cb85-14"><a href="#cb85-14"></a>root[<span class="dv">1</span>,] =<span class="st"> </span>k</span>
<span id="cb85-15"><a href="#cb85-15"></a><span class="kw">rownames</span>(root) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;k&#39;</span>,<span class="st">&#39;A(k)&#39;</span>)</span>
<span id="cb85-16"><a href="#cb85-16"></a>root</span></code></pre></div>
<pre><code>##        [,1]   [,2]   [,3]   [,4]   [,5]   [,6]    [,7]    [,8]   [,9]   [,10]
## k    4.0000 5.0000 6.0000 7.0000 8.0000 9.0000 10.0000 11.0000 12.000 13.0000
## A(k) 1.4921 1.5336 1.5627 1.5844 1.6012 1.6145  1.6254  1.6344  1.642  1.6486
##        [,11]   [,12]   [,13]   [,14]   [,15]   [,16]   [,17]   [,18]   [,19]
## k    14.0000 15.0000 16.0000 17.0000 18.0000 19.0000 20.0000 21.0000 22.0000
## A(k)  1.6542  1.6591  1.6635  1.6673  1.6707  1.6738  1.6766  1.6792  1.6815
##        [,20]   [,21]   [,22]    [,23]    [,24]     [,25]
## k    23.0000 24.0000 25.0000 100.0000 500.0000 1000.0000
## A(k)  1.6836  1.6856  1.6874   1.7206   1.7298    1.7309</code></pre>
</div>
</div>
<div id="homework-2020-11-24" class="section level2">
<h2>homework 2020-11-24</h2>
<div id="a-b-o-blood-type-problem" class="section level3">
<h3>A-B-O blood type problem</h3>
<p>Let the three alleles be A, B and O.</p>
<p>(Table omitted)</p>
<p>Observed data: A-type: <span class="math inline">\(n_{A \cdot }=444\)</span></p>
<p>B-type: <span class="math inline">\(n_{B \cdot }=132\)</span></p>
<p>O-type: <span class="math inline">\(n_{OO}=361\)</span></p>
<p>AB-type: <span class="math inline">\(n_{AB}=63\)</span></p>
<ol style="list-style-type: decimal">
<li>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>. (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>)</li>
<li>Record the values of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</li>
</ol>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="kw">library</span>(nloptr)</span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="co"># Mle </span></span>
<span id="cb87-3"><a href="#cb87-3"></a>eval_f0 =<span class="st"> </span><span class="cf">function</span>(x,x1,<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span>) {</span>
<span id="cb87-4"><a href="#cb87-4"></a>  </span>
<span id="cb87-5"><a href="#cb87-5"></a>  r1 =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x1)</span>
<span id="cb87-6"><a href="#cb87-6"></a>  nAA =<span class="st"> </span>n.A<span class="op">*</span>x1[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(x1[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x1[<span class="dv">1</span>]<span class="op">*</span>r1)</span>
<span id="cb87-7"><a href="#cb87-7"></a>  nBB =<span class="st"> </span>n.B<span class="op">*</span>x1[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(x1[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x1[<span class="dv">2</span>]<span class="op">*</span>r1)</span>
<span id="cb87-8"><a href="#cb87-8"></a>  r =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x)</span>
<span id="cb87-9"><a href="#cb87-9"></a>  <span class="kw">return</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nAA<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">1</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nBB<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">-</span></span>
<span id="cb87-10"><a href="#cb87-10"></a><span class="st">           </span>(n.A<span class="op">-</span>nAA)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>r)<span class="op">-</span>(n.B<span class="op">-</span>nBB)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">2</span>]<span class="op">*</span>r)<span class="op">-</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>x[<span class="dv">2</span>]))</span>
<span id="cb87-11"><a href="#cb87-11"></a>}</span>
<span id="cb87-12"><a href="#cb87-12"></a></span>
<span id="cb87-13"><a href="#cb87-13"></a></span>
<span id="cb87-14"><a href="#cb87-14"></a><span class="co"># constraint</span></span>
<span id="cb87-15"><a href="#cb87-15"></a>eval_g0 =<span class="st"> </span><span class="cf">function</span>(x,x1,<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span>) {</span>
<span id="cb87-16"><a href="#cb87-16"></a>  <span class="kw">return</span>(<span class="kw">sum</span>(x)<span class="op">-</span><span class="fl">0.999999</span>)</span>
<span id="cb87-17"><a href="#cb87-17"></a>}</span>
<span id="cb87-18"><a href="#cb87-18"></a></span>
<span id="cb87-19"><a href="#cb87-19"></a>opts =<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;algorithm&quot;</span>=<span class="st">&quot;NLOPT_LN_COBYLA&quot;</span>,</span>
<span id="cb87-20"><a href="#cb87-20"></a>             <span class="st">&quot;xtol_rel&quot;</span>=<span class="fl">1.0e-8</span>)</span>
<span id="cb87-21"><a href="#cb87-21"></a>mle =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb87-22"><a href="#cb87-22"></a>r =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb87-23"><a href="#cb87-23"></a>r =<span class="st"> </span><span class="kw">rbind</span>(r,<span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.35</span>))<span class="co"># the beginning value of p0 and q0</span></span>
<span id="cb87-24"><a href="#cb87-24"></a>j =<span class="st"> </span><span class="dv">2</span></span>
<span id="cb87-25"><a href="#cb87-25"></a><span class="cf">while</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(r[j,]<span class="op">-</span>r[j<span class="dv">-1</span>,]))<span class="op">&gt;</span><span class="fl">1e-8</span>) {</span>
<span id="cb87-26"><a href="#cb87-26"></a>res =<span class="st"> </span><span class="kw">nloptr</span>( <span class="dt">x0=</span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.25</span>),</span>
<span id="cb87-27"><a href="#cb87-27"></a>               <span class="dt">eval_f=</span>eval_f0,</span>
<span id="cb87-28"><a href="#cb87-28"></a>               <span class="dt">lb =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">ub =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb87-29"><a href="#cb87-29"></a>               <span class="dt">eval_g_ineq =</span> eval_g0, </span>
<span id="cb87-30"><a href="#cb87-30"></a>               <span class="dt">opts =</span> opts, <span class="dt">x1=</span>r[j,],<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span> )</span>
<span id="cb87-31"><a href="#cb87-31"></a>j =<span class="st"> </span>j<span class="op">+</span><span class="dv">1</span></span>
<span id="cb87-32"><a href="#cb87-32"></a>r =<span class="st"> </span><span class="kw">rbind</span>(r,res<span class="op">$</span>solution)</span>
<span id="cb87-33"><a href="#cb87-33"></a>mle =<span class="st"> </span><span class="kw">c</span>(mle,<span class="kw">eval_f0</span>(<span class="dt">x=</span>r[j,],<span class="dt">x1=</span>r[j<span class="dv">-1</span>,]))</span>
<span id="cb87-34"><a href="#cb87-34"></a>}</span>
<span id="cb87-35"><a href="#cb87-35"></a><span class="co">#the result of EM algorithm</span></span>
<span id="cb87-36"><a href="#cb87-36"></a>r </span></code></pre></div>
<pre><code>##            [,1]      [,2]
##  [1,] 0.0000000 0.0000000
##  [2,] 0.2000000 0.3500000
##  [3,] 0.2938636 0.1159800
##  [4,] 0.2977537 0.1034051
##  [5,] 0.2977020 0.1027454
##  [6,] 0.2976539 0.1027089
##  [7,] 0.2976433 0.1027065
##  [8,] 0.2976411 0.1027063
##  [9,] 0.2976407 0.1027063
## [10,] 0.2976407 0.1027063
## [11,] 0.2976407 0.1027063
## [12,] 0.2976407 0.1027063</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="co">#the max likelihood values</span></span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="kw">plot</span>(<span class="op">-</span>mle,<span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmZmZmtrZmtv+QOgCQZgCQkGaQ2/+2ZgC2/7a2///bkDrb/9vb////tmb/25D//7b//9v////Y4K3VAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGX0lEQVR4nO3dgXLiNhhFYSdN0oa2oV227jqB93/NWpJhkybSkY0FP9I9M53Z7jI2fDGyIUJ0B5Wsu/YdsJ6AIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBK0M1N1M1wJad3PlEhAkIOh2gK40+lgHmj9YrpxtoKuxvLsLq99wtc1d76h5n1kgEzqHiwPlDilWeGweQTaeW1P2gCzpHOwBGeMxCLTubs5PQJAxIHM+AqIEBAkIEhBkC8iej4AoAUECggQECQgyBWTQR0CUqbdcGwLabwPD/T9zNtcOUN89hz8Mxz9kba4ZoP32xNI//MjenEWfMkBvm5fjH4fIk6xtIB1BVN9Nh9CsMaghoPFJFs5ikeNHQEs2Z9JHQFShs5gbeYaZF4qtAfnz17sTPm6uMaCJZsZpvjGg1ycPNONCsR6g8Rz+8GMXucAJN1hwBNn0WQI03H0bH3YYiL8uXAU9Ho7DddZ+qwFyryPccdFHz1Cu0ejuW/xCumYg99xxQLHRZel+qwE6HkG76MuIZfutBmgag06vRxNNZ7Ks/Rr1WXoW69wIE+34UvXzm67x96RrAuKmwbnVIyijt40boQSUaDc+BxsEio8un+q75xlAVn1Kvh/0+vSLgJLtt/FLgZqBjk+zVa+kKwLab8+6hI7styKg6JuE5+zXrM/C12JQxrmuYqDD66+JVxmh/ZYGqKqBnniQ3m8fZ+23JiB87L4BXuxXDKRBGm6YMUjP3q9dn0KDdChFWTHQ6RyOV9KNAuXXMFDeOPTFrSJvuQoovTnDPkWBsjcnINicgGBz9QGtvF8BpTdn2UdAlIAgAUECggwAmfYRECUgSECQgCABQdcHsu0jIEpAUCGg2MoLX7wn3STQnJUXWgSa87l54z5lgOasvNAkkI4gasbKC20CzVh5oVGg7M1Z9xEQVQho13WP/mIxNhutcSD/kU33sWf81HObQP40P/jPJNJpvk0gf6EYLhHpQrFNoPwjyLxP6TEoOg2kcaDss1izQLmbExBsrnEg/FCvfZ9Sp/nMlRdaBcpeeaFZoAUrL1it2Bg0d+UFq5UbpOetvGC2gmexWSsvmK3kaT658sLNVBBoSRm74ZusspG5j1hA6958aW0AzVhlaMFuKgDKWHnhjN3UAJS5+sCy3VQBhCsvnLGbOoCWJqDzd1MP0DqLWNxKAoIEBAkIEhB0M2/gXCsBQQKCBAQJCBIQJCBIQNAFgPyMK762hG88cSupwrt1fRef2RW28Zt/Q3RIfzvGx8oD7bfjvenpwY33Ogk0jP/6tklupPffOpQQetuECajudtlC5YHCL6rT36k0fXdX/J/Dy5vkRsLbwbu44RB+1RA2lbjdxy41BtGPrH/4KwWUtZZzGmjonv3k5bwf2KlLAe3Sd2gESI5Bw/33DQ1k+BQLs7uDdfaXYF0IKP6NZD532CeBevfsoN+p4ODrVcKxnD0IXQZogDEav7erv+MfuztIX59SPwizQHD8hKM+DeRpEhOTssYWq0+xnq6C+un32fGHHx5PcqjOODKMDtI53+l2gCMofOA6+WMPDzx5k8HkaT49LPwsfSXtRil4rzdzDDJ3oTg9f/AewUuNgV+v7Ogm0+HV23qpceMJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQZA/o07yC/IkGJRIQJCDIJNDb5s9NmG/mZqr87YD6MLXFTQyLLmZdJKNAbnL++J+bEzV00/+4yVFuDlVsJeIyGQV69lPqwqy63fQXfv7TcP/994s+44wCvfhpiacpc2EY8l47/NTHupkG6k9AP6fBLl1/Zmmmgf53BLn22z+WLvK0LNNA05Tm6S98/cO/l13XwDTQ9PmU6SwWRuuX/Enyq2Qb6ON10Aiz89OlLzlM2wMyloAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIOg/YeQHY4GZCSQAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="p204-exercises-3" class="section level3">
<h3>p204 Exercises 3</h3>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list(</p>
<p>mpg ~ disp,</p>
<p>mpg ~ I(1 / disp),</p>
<p>mpg ~ disp + wt,</p>
<p>mpg ~ I(1 / disp) + wt</p>
<p>)</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb90-2"><a href="#cb90-2"></a></span>
<span id="cb90-3"><a href="#cb90-3"></a>formulas =<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb90-4"><a href="#cb90-4"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb90-5"><a href="#cb90-5"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb90-6"><a href="#cb90-6"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb90-7"><a href="#cb90-7"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb90-8"><a href="#cb90-8"></a>)</span>
<span id="cb90-9"><a href="#cb90-9"></a><span class="co">#1 for loops</span></span>
<span id="cb90-10"><a href="#cb90-10"></a>f3 =<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas))</span>
<span id="cb90-11"><a href="#cb90-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)){</span>
<span id="cb90-12"><a href="#cb90-12"></a>  f3[[i]] =<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], <span class="dt">data =</span> mtcars)</span>
<span id="cb90-13"><a href="#cb90-13"></a>}</span>
<span id="cb90-14"><a href="#cb90-14"></a>f3</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="co">#2 lapply</span></span>
<span id="cb92-2"><a href="#cb92-2"></a>la3 =<span class="st"> </span><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="kw">lm</span>(<span class="dt">formula =</span> x, <span class="dt">data =</span> mtcars))</span>
<span id="cb92-3"><a href="#cb92-3"></a>la3</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="p214-exercises-3" class="section level3">
<h3>p214 Exercises 3</h3>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb94-2"><a href="#cb94-2"></a>trials =<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb94-3"><a href="#cb94-3"></a><span class="dv">100</span>,</span>
<span id="cb94-4"><a href="#cb94-4"></a><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb94-5"><a href="#cb94-5"></a><span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb94-6"><a href="#cb94-6"></a>)</span>
<span id="cb94-7"><a href="#cb94-7"></a><span class="co"># anonymous function:</span></span>
<span id="cb94-8"><a href="#cb94-8"></a><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x[[<span class="st">&quot;p.value&quot;</span>]])</span></code></pre></div>
<pre><code>##   [1] 9.813226e-01 1.619096e-05 6.242135e-01 6.693526e-01 5.677105e-01
##   [6] 6.610740e-01 5.951636e-01 5.005347e-01 4.763110e-01 3.429965e-01
##  [11] 8.155394e-01 7.197238e-01 1.244336e-01 2.229164e-01 1.113099e-02
##  [16] 4.625765e-01 6.515865e-01 1.658793e-01 9.342672e-01 8.011934e-01
##  [21] 4.627657e-01 5.927934e-01 2.929669e-01 5.737967e-01 3.451537e-02
##  [26] 2.739138e-01 2.656151e-01 8.196695e-01 6.647355e-01 8.056529e-01
##  [31] 5.060850e-01 7.106543e-01 2.321066e-01 1.106223e-01 5.459279e-01
##  [36] 1.865470e-02 2.433776e-01 2.688851e-01 9.819256e-01 4.940184e-01
##  [41] 3.268275e-01 8.000439e-01 9.822499e-01 1.936454e-01 7.390101e-01
##  [46] 3.888930e-02 4.350424e-01 7.434339e-02 5.787441e-01 4.864951e-01
##  [51] 1.476288e-01 5.524909e-01 7.129280e-01 8.683479e-03 9.053256e-02
##  [56] 4.415463e-01 4.955063e-01 1.745328e-01 6.615399e-01 4.479199e-01
##  [61] 2.885849e-01 3.028567e-02 1.018907e-01 1.811861e-02 6.376441e-01
##  [66] 1.408742e-02 9.008128e-02 4.515933e-01 8.703291e-01 7.250768e-01
##  [71] 8.183571e-01 8.465036e-01 8.786838e-01 1.651543e-01 3.951569e-01
##  [76] 1.754280e-01 3.649865e-01 7.224226e-02 6.565152e-01 9.946559e-01
##  [81] 3.715952e-01 8.424336e-02 4.549887e-01 8.530113e-01 1.970777e-01
##  [86] 2.298117e-01 1.148832e-01 7.769502e-01 4.934348e-01 3.526049e-01
##  [91] 2.036013e-01 8.838914e-01 6.474880e-02 4.089082e-01 5.780132e-01
##  [96] 8.011408e-01 5.956061e-01 9.266689e-01 9.923205e-02 1.763972e-01</code></pre>
</div>
<div id="p214-exercises-6" class="section level3">
<h3>p214 Exercises 6</h3>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
<p>We use the dataset mtcars and faithful as the example, what we expect is something like the following result:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>datalist &lt;-<span class="st"> </span><span class="kw">list</span>(mtcars, faithful)</span>
<span id="cb96-2"><a href="#cb96-2"></a><span class="kw">lapply</span>(datalist, <span class="cf">function</span>(x) <span class="kw">vapply</span>(x, mean, <span class="kw">numeric</span>(<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## [[1]]
##        mpg        cyl       disp         hp       drat         wt       qsec 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
##         vs         am       gear       carb 
##   0.437500   0.406250   3.687500   2.812500 
## 
## [[2]]
## eruptions   waiting 
##  3.487783 70.897059</code></pre>
<p>We can get similar result with a the following function:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>mylapply &lt;-<span class="st"> </span><span class="cf">function</span>(X, FUN, FUN.VALUE, <span class="dt">simplify =</span> <span class="ot">FALSE</span>){</span>
<span id="cb98-2"><a href="#cb98-2"></a>  out &lt;-<span class="st"> </span><span class="kw">Map</span>(<span class="cf">function</span>(x) <span class="kw">vapply</span>(x, FUN, FUN.VALUE), X)</span>
<span id="cb98-3"><a href="#cb98-3"></a>  <span class="cf">if</span>(simplify <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>) <span class="kw">return</span>(<span class="kw">simplify2array</span>(out))</span>
<span id="cb98-4"><a href="#cb98-4"></a>  <span class="kw">unlist</span>(out)</span>
<span id="cb98-5"><a href="#cb98-5"></a>}</span>
<span id="cb98-6"><a href="#cb98-6"></a><span class="kw">mylapply</span>(datalist, mean, <span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        mpg        cyl       disp         hp       drat         wt       qsec 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
##         vs         am       gear       carb  eruptions    waiting 
##   0.437500   0.406250   3.687500   2.812500   3.487783  70.897059</code></pre>
</div>
<div id="question-1" class="section level3">
<h3>Question</h3>
<p>You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R). Rewrite an Rcpp function for the same task.</p>
<ol style="list-style-type: decimal">
<li><p>Compare the generated random numbers by the two functions using qqplot.</p></li>
<li><p>Campare the computation time of the two functions with microbenchmark.</p></li>
<li><p>Comments your results。</p></li>
</ol>
</div>
<div id="rcpp" class="section level3">
<h3>Rcpp</h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="co">#include &lt;cmath&gt;</span></span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb100-3"><a href="#cb100-3"></a>using namespace Rcpp;</span>
<span id="cb100-4"><a href="#cb100-4"></a></span>
<span id="cb100-5"><a href="#cb100-5"></a>double <span class="kw">f</span>(double x) {</span>
<span id="cb100-6"><a href="#cb100-6"></a>  return <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x));</span>
<span id="cb100-7"><a href="#cb100-7"></a>}</span>
<span id="cb100-8"><a href="#cb100-8"></a></span>
<span id="cb100-9"><a href="#cb100-9"></a><span class="op">/</span><span class="er">/</span>[[Rcpp<span class="op">::</span>export]]</span>
<span id="cb100-10"><a href="#cb100-10"></a>NumericVector <span class="kw">rwMetropolis</span> (double sigma, double x0, int N) {</span>
<span id="cb100-11"><a href="#cb100-11"></a>  NumericVector <span class="kw">x</span>(N);</span>
<span id="cb100-12"><a href="#cb100-12"></a>  x[<span class="dv">0</span>] =<span class="st"> </span>x0; </span>
<span id="cb100-13"><a href="#cb100-13"></a>  NumericVector u =<span class="st"> </span><span class="kw">runif</span>(N);</span>
<span id="cb100-14"><a href="#cb100-14"></a>  <span class="cf">for</span> (int <span class="dt">i =</span> <span class="dv">1</span>; i <span class="op">&lt;</span><span class="st"> </span>N;i<span class="op">++</span><span class="st"> </span>) {</span>
<span id="cb100-15"><a href="#cb100-15"></a>    NumericVector y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma);</span>
<span id="cb100-16"><a href="#cb100-16"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">f</span>(y[<span class="dv">0</span>]) <span class="op">/</span><span class="st"> </span><span class="kw">f</span>(x[i<span class="dv">-1</span>]))){</span>
<span id="cb100-17"><a href="#cb100-17"></a>      x[i] =<span class="st"> </span>y[<span class="dv">0</span>];</span>
<span id="cb100-18"><a href="#cb100-18"></a>    }</span>
<span id="cb100-19"><a href="#cb100-19"></a>    <span class="cf">else</span> { </span>
<span id="cb100-20"><a href="#cb100-20"></a>      x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]; </span>
<span id="cb100-21"><a href="#cb100-21"></a>    }</span>
<span id="cb100-22"><a href="#cb100-22"></a>  }</span>
<span id="cb100-23"><a href="#cb100-23"></a>  <span class="kw">return</span>(x);</span>
<span id="cb100-24"><a href="#cb100-24"></a>} </span></code></pre></div>
</div>
<div id="comparison-of-the-computation-time" class="section level3">
<h3>comparison of the computation time</h3>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>    <span class="kw">library</span>(Rcpp)</span>
<span id="cb101-2"><a href="#cb101-2"></a>    <span class="kw">library</span>(StatComp20049)</span>
<span id="cb101-3"><a href="#cb101-3"></a>    <span class="kw">library</span>(microbenchmark)</span>
<span id="cb101-4"><a href="#cb101-4"></a>    <span class="co"># R</span></span>
<span id="cb101-5"><a href="#cb101-5"></a>    lap_f =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb101-6"><a href="#cb101-6"></a></span>
<span id="cb101-7"><a href="#cb101-7"></a>    rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb101-8"><a href="#cb101-8"></a>    x =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb101-9"><a href="#cb101-9"></a>    x[<span class="dv">1</span>] =<span class="st"> </span>x0</span>
<span id="cb101-10"><a href="#cb101-10"></a>    u =<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb101-11"><a href="#cb101-11"></a>    k =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb101-12"><a href="#cb101-12"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb101-13"><a href="#cb101-13"></a>    y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb101-14"><a href="#cb101-14"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap_f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap_f</span>(x[i<span class="dv">-1</span>]))) x[i] =<span class="st"> </span>y </span>
<span id="cb101-15"><a href="#cb101-15"></a>    <span class="cf">else</span> {</span>
<span id="cb101-16"><a href="#cb101-16"></a>    x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb101-17"><a href="#cb101-17"></a>    k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb101-18"><a href="#cb101-18"></a>     }</span>
<span id="cb101-19"><a href="#cb101-19"></a>    }</span>
<span id="cb101-20"><a href="#cb101-20"></a>     <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</span>
<span id="cb101-21"><a href="#cb101-21"></a>    }</span>
<span id="cb101-22"><a href="#cb101-22"></a>    </span>
<span id="cb101-23"><a href="#cb101-23"></a>    x0 =<span class="st"> </span><span class="dv">25</span></span>
<span id="cb101-24"><a href="#cb101-24"></a>    N =<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb101-25"><a href="#cb101-25"></a>    sigma =<span class="st"> </span><span class="dv">2</span></span>
<span id="cb101-26"><a href="#cb101-26"></a>    (<span class="dt">time =</span> <span class="kw">microbenchmark</span>(<span class="dt">rwR=</span><span class="kw">rw.Metropolis</span>(sigma,x0,N),<span class="dt">rwC=</span><span class="kw">rwMetropolis</span>(sigma,x0,N)))</span></code></pre></div>
<pre><code>## Unit: microseconds
##  expr    min      lq      mean   median       uq     max neval
##   rwR 7366.6 9153.05 11810.433 10253.55 13145.40 41350.4   100
##   rwC  484.0  509.50   598.394   541.25   693.35   923.2   100</code></pre>
<p>We can see that the running time of using Cpp functionis much shorter than using R function.So using Rcpp method can improve computing efficiency.</p>
</div>
<div id="qqplot" class="section level3">
<h3>qqplot</h3>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb103-2"><a href="#cb103-2"></a>rwR =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma,x0,N)<span class="op">$</span>x[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>)]</span>
<span id="cb103-3"><a href="#cb103-3"></a>rwC =<span class="st"> </span><span class="kw">rwMetropolis</span>(sigma,x0,N)[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>)]</span>
<span id="cb103-4"><a href="#cb103-4"></a><span class="kw">qqplot</span>(rwR,rwC)</span>
<span id="cb103-5"><a href="#cb103-5"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;black&#39;</span>)</span></code></pre></div>
<p>The dots of qqplot are located close to the diagonal lines. The random numbers generated by the two functions are similar.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
